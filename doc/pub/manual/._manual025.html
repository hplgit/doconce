<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="DocOnce Description">
<meta name="keywords" content="doconce,demos,author email,author institution,table of contents,headlines,section headings,headings,running programs,output from programs,comment lines,tables,lists,itemized lists,lists unordered,lists bullets,enumerated lists,ordered lists,lists ordered,lists enumerated,description lists,keyword lists,lists descriptions,lists keywords,inline tagging,emphasized words,boldface words,inline verbatim text,verbatim text, inline,links,hyperlinks,quotation syntax,quotation,non-breaking space,non-breaking space,nbsp,horizontal rule,m-dash,em-dash,ampersand,footnotes,inline comments,comments, inline,track changes,inline comments for editing,linebreak,citations,inline mathematics,formulas (math),mathematical formulas,cross referencing,labels,references,citations,citations, generalized,generalized citations,cross-document referencing,index,some index entry,main entry subentry,emojis,smileys,exercise environment,problem environment,project environment,example environment,verbatim text, code blocks,code blocks,syntax highlighting,computer code blocks,mathematical equations,equations,LaTeX blocks with math,MS Word,Word (Microsoft),LaTeX newcommands,newcommands (LaTeX),macros (LaTeX),algorithms,admonitions,warning admon,notice admon,summary admon,question admon,block admon,admonition layout,HTML admonitions,LaTeX admonitions,box environment,frame (box) environment,equation with frame,bibliography,reference list,Publish (for bibliography),BibTeX,bibliography, database,citations,LaTeX bibliographic styles,preprocessing,splitting documents,multi-page documents,slides,HTML5 slides,LaTeX slides,Markdown slides,slide syntax,Emacs doconce support,doconce syntax highlighting,preprocessing,inline comments,notes (visible/invisible),demos,HTML output,output format HTML,HTML syntax highlighting,HTML movies,movies in HTML,HTML layouts,HTML templates,splitting documents,multi-page documents,HTML file collection,blog posts,Wordpress blog,Google blogger,output format Markdown,output format Pandoc,Markdown output,Pandoc output,output format strict Markdown,output format GitHub-flavored Markdown,output format strapdown Markdown,LaTeX output,output format LaTeX,LaTeX style options,LaTeX syntax highlighting,output format pdfLaTeX,pdfLaTeX output,output format XeLaTeX,XeLaTeX output,ePub output,output format ePub,output format MS Word,output format LibreOffice,output format OpenOffice,output format ASCII,output format plain untagged text,ASCII output,plain untagged text output,output format reStructuredText,reStructuredText output,output format Sphinx,Sphinx output,Sphinx styles,Sphinx directory,output format MediaWiki,output format Creole wiki,output format Google wiki,MediaWiki output,Google wiki output,Creole wiki output,wiki output,Google docs output,tweaking output,automatic editing,doconce format options,command-line options doconce format,installation">

<title>DocOnce Description</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="http://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(' What Is DocOnce? ', 1, 'what:is:doconce', 'what:is:doconce'),
              (' Demos ', 2, None, '___sec1'),
              (' Markup Based on Special Lines ', 1, None, '___sec2'),
              (' Heading with title and author(s) ', 2, None, '___sec3'),
              (' Table of contents ', 2, None, '___sec4'),
              (' Section headings ', 2, None, '___sec5'),
              (' Figures ', 2, None, '___sec6'),
              (' Movies ', 2, None, '___sec7'),
              (' The Basic Command ', 3, None, '___sec8'),
              (' MP4, WebM, and Ogg Movies in HTML ', 3, None, '___sec9'),
              (' Movie Handling in Various Formats ', 3, None, '___sec10'),
              (' YouTube and Vimeo Movies ', 3, None, '___sec11'),
              (' Animation Based on Filename Generators ',
               3,
               None,
               '___sec12'),
              (' Copying Computer Code from Source Files ',
               2,
               None,
               '___sec13'),
              (' Inserting the Output from Operating System Commands ',
               2,
               None,
               '___sec14'),
              (' Comments ', 2, None, '___sec15'),
              (' Tables ', 2, None, '___sec16'),
              (' Basic Syntax ', 3, None, '___sec17'),
              (' Tables to/from CSV Data Files ', 3, None, '___sec18'),
              (' Lists ', 2, None, '___sec19'),
              (' Inline Tagging ', 1, 'inline:tagging', 'inline:tagging'),
              (' Emphasized Words ', 2, None, '___sec21'),
              (' Inline Verbatim Text ', 2, None, '___sec22'),
              (' Links to Web Addresses ', 2, None, '___sec23'),
              (' Links to Mail Addresses ', 2, None, '___sec24'),
              (' Links to Local Files ', 2, None, '___sec25'),
              (' Quotes ', 2, None, '___sec26'),
              (' Non-Breaking Space ', 2, None, '___sec27'),
              (' Horizontal rule ', 2, None, '___sec28'),
              (' Em-dash ', 2, None, '___sec29'),
              (' Ampersand ', 2, None, '___sec30'),
              (' Footnotes ', 2, None, '___sec31'),
              (' Inline Comments ', 2, None, '___sec32'),
              (' Inline Comments for Editing ', 2, None, '___sec33'),
              (' Forced Line Breaks ', 2, None, '___sec34'),
              (' Inline Mathematics ', 2, None, '___sec35'),
              (' Cross-Referencing ', 2, None, '___sec36'),
              (' Generalized Cross-Referencing ',
               2,
               'manual:genrefs',
               'manual:genrefs'),
              (' A Worked Example ', 3, None, '___sec38'),
              (' Index ', 2, None, '___sec39'),
              (' Emojis ', 2, None, '___sec40'),
              (' Environments ', 1, None, '___sec41'),
              (' Exercises, Problems, Projects, and Examples ',
               2,
               None,
               '___sec42'),
              (' List of Exercises, Problems, and Projects ',
               3,
               None,
               '___sec43'),
              (' Blocks of Verbatim Computer Code ',
               2,
               'sec:verbatim:blocks',
               'sec:verbatim:blocks'),
              (' Typesetting Styles ', 3, None, '___sec45'),
              (' Copying Code from Source Files ', 3, None, '___sec46'),
              (' The `fromto` and `from-to` directives ',
               3,
               None,
               '___sec47'),
              (' LaTeX Blocks of Mathematical Text ',
               2,
               'mathtext',
               'mathtext'),
              (' Support of LaTeX Math in Various Output Formats ',
               3,
               None,
               '___sec49'),
              (' Dealing with Mathematics in Formats without LaTeX Math Support ',
               3,
               None,
               '___sec50'),
              (' Mathematics for PowerPoint/OpenOffice ',
               3,
               None,
               '___sec51'),
              (' Macros (Newcommands) ', 2, 'newcommands', 'newcommands'),
              (' Guidelines for LaTeX Writers ', 2, None, '___sec53'),
              (' Typesetting of Algorithms ', 2, None, '___sec54'),
              (' Admonitions ', 2, None, '___sec55'),
              (' Examples on Admonition Types ', 3, None, '___sec56'),
              (' Layout of admonitions in HTML ', 3, None, '___sec57'),
              (' Layout of admonitions in LaTeX ', 3, None, '___sec58'),
              (' LaTeX code environments inside admonitions ',
               3,
               None,
               '___sec59'),
              (' The Box Environment ', 3, None, '___sec60'),
              (' Bibliography (References) ', 1, None, '___sec61'),
              (' Importing your data to the Publish database ',
               2,
               None,
               '___sec62'),
              (' Requirements to input data ', 2, None, '___sec63'),
              (' Adding new references to the database ',
               2,
               None,
               '___sec64'),
              (' Exporting the database ', 2, None, '___sec65'),
              (' Referring to publications ', 2, None, '___sec66'),
              (' Specifying the Publish database ', 2, None, '___sec67'),
              (' LaTeX Bibliography Style ', 2, None, '___sec68'),
              (' Preprocessing and Postprocessing ', 1, None, '___sec69'),
              (' The Preprocess and Mako Preprocessors ',
               2,
               None,
               '___sec70'),
              (' Splitting Documents into Smaller Pieces ',
               2,
               None,
               '___sec71'),
              (' Writing Slides ', 1, None, '___sec72'),
              (' Overview ', 2, None, '___sec73'),
              (' Slide Types ', 3, None, '___sec74'),
              (' Syntax ', 3, None, '___sec75'),
              (' Slide Elements ', 2, None, '___sec76'),
              (' Title page ', 3, None, '___sec77'),
              (' Parts Page ', 3, None, '___sec78'),
              (' Standard bullet list page ', 3, None, '___sec79'),
              (' Equations, movies, figures ', 3, None, '___sec80'),
              (' HTML5 Slides ', 2, None, '___sec81'),
              (' Potential Problems ', 3, None, '___sec82'),
              (' LaTeX Beamer Slides ', 2, None, '___sec83'),
              (' Themes ', 3, None, '___sec84'),
              (' Pop of list items and blocks ', 3, None, '___sec85'),
              (' Compilation ', 3, None, '___sec86'),
              (' Misc ', 1, None, '___sec87'),
              (' Missing Features ', 2, None, '___sec88'),
              (' Emacs DocOnce Formatter ',
               2,
               'emacs:doconce',
               'emacs:doconce'),
              (' Mako Programming ', 1, 'manual:mako', 'manual:mako'),
              (' The Basics of Mako ', 2, None, '___sec91'),
              (' Debugging Python code in Mako ',
               2,
               'mako:py:debugging',
               'mako:py:debugging'),
              (' Example: Executing Python and using SymPy Objects in LaTeX ',
               2,
               None,
               '___sec93'),
              (' Example: Extending Tables to Handle Figures ',
               2,
               'manual:tables:wfigs',
               'manual:tables:wfigs'),
              (' Solution for LaTeX and HTML ', 3, None, '___sec95'),
              (' Generating the Entire Table ', 3, None, '___sec96'),
              (' Generating the Entire Table in a Native Format via Mako ',
               3,
               None,
               '___sec97'),
              (' Generating the Entire Table in a Native Format as a Post Process ',
               3,
               None,
               '___sec98'),
              (' Example: Defining a Theorem Environment ',
               2,
               'manual:theorem:envir',
               'manual:theorem:envir'),
              (' Tools for Writing DocOnce Documents ', 2, None, '___sec100'),
              (' Debugging ', 2, None, '___sec101'),
              (' From DocOnce to Other Formats ',
               1,
               'doconce2formats',
               'doconce2formats'),
              (' Generating a makefile ', 2, None, '___sec103'),
              (' Preprocessing ', 2, None, '___sec104'),
              (' Removal of inline comments ', 2, None, '___sec105'),
              (' Notes ', 2, None, '___sec106'),
              (' Demo of different formats ', 2, None, '___sec107'),
              (' HTML ', 2, None, '___sec108'),
              (' Basics ', 3, None, '___sec109'),
              (' Typesetting of Code ', 3, None, '___sec110'),
              (' Handling of Movies ', 3, None, '___sec111'),
              (' HTML Styles ', 3, None, '___sec112'),
              (' HTML templates ', 3, None, '___sec113'),
              (' Splitting HTML documents ', 3, None, '___sec114'),
              (' The HTML File Collection ', 3, None, '___sec115'),
              (' Filenames ', 3, None, '___sec116'),
              (' URL to files hosted on GitHub ', 3, None, '___sec117'),
              (' Other HTML options ', 3, None, '___sec118'),
              (' Blog Posts ', 2, None, '___sec119'),
              (' Pandoc and Markdown ', 2, None, '___sec120'),
              (' Markdown to HTML conversion ', 3, None, '___sec121'),
              (' Strict Markdown ', 3, None, '___sec122'),
              (' GitHub-flavored Markdown ', 3, None, '___sec123'),
              (' MultiMarkdown ', 3, None, '___sec124'),
              (' Strapdown rendering of Markdown text ',
               3,
               None,
               '___sec125'),
              (' Using Pandoc to go from LaTeX to MS Word or HTML ',
               3,
               None,
               '___sec126'),
              (' LaTeX ', 2, None, '___sec127'),
              (' PDFLaTeX ', 2, None, '___sec128'),
              (' XeLaTeX ', 2, None, '___sec129'),
              (' From PDF to e-book formats ', 2, None, '___sec130'),
              (' Microsoft Word or LibreOffice ', 2, None, '___sec131'),
              (' Plain ASCII Text ', 2, None, '___sec132'),
              (' reStructuredText ', 2, None, '___sec133'),
              (' Sphinx ', 2, None, '___sec134'),
              (' The manual Sphinx procedure ', 3, None, '___sec135'),
              (' Wiki Formats ', 2, None, '___sec136'),
              (' Google Docs ', 2, None, '___sec137'),
              (' Tweaking the DocOnce Output ', 2, None, '___sec138'),
              (' Options for the `doconce` commands ', 1, None, '___sec139'),
              (' `doconce format` command-line options ',
               2,
               None,
               '___sec140'),
              (' Installation of DocOnce and its Dependencies ',
               1,
               'install:doconce',
               'install:doconce'),
              (' DocOnce ', 2, None, '___sec142'),
              (' Dependencies ', 2, None, '___sec143'),
              (' Preprocessors ', 3, None, '___sec144'),
              (' Image file handling ', 3, None, '___sec145'),
              (' Spellcheck ', 3, None, '___sec146'),
              (' Bibliography ', 3, None, '___sec147'),
              (' Ptex2tex for LaTeX Output ', 3, None, '___sec148'),
              (' LaTeX packages ', 3, None, '___sec149'),
              (' reStructuredText (reST) Output ', 3, None, '___sec150'),
              (' Sphinx Output ', 3, None, '___sec151'),
              (' Markdown and Pandoc Output ', 3, None, '___sec152'),
              (' Epydoc Output ', 3, None, '___sec153'),
              (' Analyzing file differences ', 3, None, '___sec154'),
              (' Quick Debian/Ubuntu Install ',
               2,
               'install:debian:script',
               'install:debian:script'),
              (' Basic Parsing Ideas ', 1, None, '___sec156'),
              (' Typesetting of Function Arguments, Return Values, and Variables ',
               2,
               None,
               '___sec157'),
              (' References ', 1, None, '___sec158')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="manual.html">DocOnce Description</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._manual000.html#what:is:doconce" style="font-size: 80%;">What Is DocOnce?</a></li>
     <!-- navigation toc: --> <li><a href="._manual003.html#___sec2" style="font-size: 80%;">Markup Based on Special Lines</a></li>
     <!-- navigation toc: --> <li><a href="._manual010.html#inline:tagging" style="font-size: 80%;">Inline Tagging</a></li>
     <!-- navigation toc: --> <li><a href="._manual013.html#___sec41" style="font-size: 80%;">Environments</a></li>
     <!-- navigation toc: --> <li><a href="._manual017.html#___sec61" style="font-size: 80%;">Bibliography (References)</a></li>
     <!-- navigation toc: --> <li><a href="._manual018.html#___sec69" style="font-size: 80%;">Preprocessing and Postprocessing</a></li>
     <!-- navigation toc: --> <li><a href="._manual020.html#___sec72" style="font-size: 80%;">Writing Slides</a></li>
     <!-- navigation toc: --> <li><a href="._manual022.html#___sec87" style="font-size: 80%;">Misc</a></li>
     <!-- navigation toc: --> <li><a href="._manual023.html#manual:mako" style="font-size: 80%;">Mako Programming</a></li>
     <!-- navigation toc: --> <li><a href="._manual028.html#doconce2formats" style="font-size: 80%;">From DocOnce to Other Formats</a></li>
     <!-- navigation toc: --> <li><a href="._manual028.html#___sec139" style="font-size: 80%;">Options for the `doconce` commands</a></li>
     <!-- navigation toc: --> <li><a href="._manual029.html#install:doconce" style="font-size: 80%;">Installation of DocOnce and its Dependencies</a></li>
     <!-- navigation toc: --> <li><a href="._manual029.html#___sec156" style="font-size: 80%;">Basic Parsing Ideas</a></li>
     <!-- navigation toc: --> <li><a href="._manual029.html#___sec158" style="font-size: 80%;">References</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0025"></a>
<!-- !split -->

<h2 id="manual:tables:wfigs">Example: Extending Tables to Handle Figures<a name="manual:tables:wfigs"></a></h2>

<p>
DocOnce tables cannot contain figures, since figures must appear on
a single line with the special syntax <code>FIGURE: [file, ...]</code>.
What if you want a table of thumbnail figures with hyperlinks?

<h3 id="___sec95">Solution for LaTeX and HTML <a name="___sec95"></a></h3>

<p>
We first restrict the attention to LaTeX and HTML. In those cases
we can create an ordinary table and insert a call to a Mako
function in cells in the table to return the proper LaTeX or
HTML code for displaying a figure.

<p>
The Mako call syntax in a cell is decided to be
<code>${tfig('080')}</code>, which insert the figure <code>mov/wave_frames/frame_0080.png</code>.
A 3x3 table of figures then look like

<p>

<!-- code=doconce (!bc do) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BA2121">|-------------------------------------------------|</span>
<span style="color: #BA2121">|               |                |                |</span>
<span style="color: #BA2121">|-------c---------------c----------------c--------|</span>
<span style="color: #BA2121">|${tfig(&#39;080&#39;)} | ${tfig(&#39;085&#39;)} | ${tfig(&#39;090&#39;)} |</span>
<span style="color: #BA2121">|${tfig(&#39;095&#39;)} | ${tfig(&#39;100&#39;)} | ${tfig(&#39;105&#39;)} |</span>
<span style="color: #BA2121">|${tfig(&#39;110&#39;)} | ${tfig(&#39;115&#39;)} | ${tfig(&#39;120&#39;)} |</span>
<span style="color: #BA2121">|-------------------------------------------------|</span>
</pre></div>
<p>
We do not want a heading, just a grid of figures, but a heading is
required in DocOnce figures, so the solution is to provide
empty column names in the heading. This solution
gives acceptable results in HTML and LaTeX.

<p>
The Mako function can be a plain Python function:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&lt;%</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">tfig</span>(fileno):
    p <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;mov/wave_frames/frame_0&#39;</span> <span style="color: #666666">+</span> fileno <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;.png&#39;</span>  <span style="color: #408080; font-style: italic"># path</span>
    <span style="color: #008000; font-weight: bold">if</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;latex&quot;</span>, <span style="color: #BA2121">&quot;pdflatex&quot;</span>):
        text <span style="color: #666666">=</span> <span style="color: #BA2121">r&#39;\includegraphics[width=2cm]{</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">}&#39;</span> <span style="color: #666666">%</span> p
    <span style="color: #008000; font-weight: bold">elif</span> FORMAT <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;html&quot;</span>:
        text <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&lt;a href=&quot;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&quot;&gt;&lt;img src=&quot;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&quot; width=&quot;300&quot;&gt;&lt;/a&gt;&#39;</span> <span style="color: #666666">%</span> (p, p)
    <span style="color: #008000; font-weight: bold">else</span>:
        text <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&quot;`</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">`&quot;: &quot;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&quot;&#39;</span> <span style="color: #666666">%</span> (fileno, p)  <span style="color: #408080; font-style: italic"># plain link</span>
    <span style="color: #008000; font-weight: bold">return</span> text
<span style="color: #666666">%&gt;</span>
</pre></div>
<p>
Note that for other formats than LaTeX and HTML we just return a link to
the figure.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Notice.</b>
A corresponding solution
for Sphinx will not work because inline figures in Sphinx has
a syntax with pipe symbols ('|') that interfer with the
column separator in tables in DocOnce. Returning the HTML
code in case of Sphinx will just display that HTML code
in the cells, not the rendered HTML code. A solution that
includes Sphinx is provided later.
</div>


<p>
The resulting table is displayed below.

<p>
<!-- @@@FIGTABLE 3x3 080 085 090 095 100 105 110 115 120 -->

<p>
<!-- Cannot just have the Mako code here and generate the table -->
<!-- because this manual cannot be run with Mako (--no_mako -->
<!-- is used in make.sh). -->
<!-- The code below is generated by having the Mako function -->
<!-- and table in a separate file _figtable.do.txt and then -->
<!-- manually generating the various formats and inserting -->
<!-- them here. -->

<p>
<!-- html -->
<p>
<table border="1">
<tr></tr>
<tr><td align="center">   <a href="mov/wave_frames/frame_0080.png"><img src="mov/wave_frames/frame_0080.png" width="300"></a>    </td> <td align="center">   <a href="mov/wave_frames/frame_0085.png"><img src="mov/wave_frames/frame_0085.png" width="300"></a>    </td> <td align="center">   <a href="mov/wave_frames/frame_0090.png"><img src="mov/wave_frames/frame_0090.png" width="300"></a>    </td> </tr>
<tr><td align="center">   <a href="mov/wave_frames/frame_0095.png"><img src="mov/wave_frames/frame_0095.png" width="300"></a>    </td> <td align="center">   <a href="mov/wave_frames/frame_0100.png"><img src="mov/wave_frames/frame_0100.png" width="300"></a>    </td> <td align="center">   <a href="mov/wave_frames/frame_0105.png"><img src="mov/wave_frames/frame_0105.png" width="300"></a>    </td> </tr>
<tr><td align="center">   <a href="mov/wave_frames/frame_0110.png"><img src="mov/wave_frames/frame_0110.png" width="300"></a>    </td> <td align="center">   <a href="mov/wave_frames/frame_0115.png"><img src="mov/wave_frames/frame_0115.png" width="300"></a>    </td> <td align="center">   <a href="mov/wave_frames/frame_0120.png"><img src="mov/wave_frames/frame_0120.png" width="300"></a>    </td> </tr>
</table>

<h3 id="___sec96">Generating the Entire Table <a name="___sec96"></a></h3>

<p>
The specific structure of this table also suggest using Mako
to generate the entire table:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&lt;%</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">generate_table</span>(start, end, step, no_of_columns):
    <span style="color: #408080; font-style: italic"># Heading</span>
    text <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span>
    horizontal_rule <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;|----|</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
    text <span style="color: #666666">+=</span> horizontal_rule
    text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;|  &#39;</span><span style="color: #666666">*</span>no_of_columns <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;|</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
    text <span style="color: #666666">+=</span> horizontal_rule
    fig_counter <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    <span style="color: #008000; font-weight: bold">for</span> counter <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(start, end<span style="color: #666666">+1</span>, step):
        fig_counter <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
        text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;| &#39;</span> <span style="color: #666666">+</span> tfig(<span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%03d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> counter) <span style="color: #666666">+</span> <span style="color: #BA2121">&#39; &#39;</span>
        <span style="color: #008000; font-weight: bold">if</span> fig_counter <span style="color: #666666">%</span> no_of_columns <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
            text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;|</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
    text <span style="color: #666666">+=</span> horizontal_rule
    <span style="color: #008000; font-weight: bold">return</span> text
<span style="color: #666666">%&gt;</span>

${generate_table(<span style="color: #666666">80</span>, <span style="color: #666666">120</span>, <span style="color: #666666">5</span>, <span style="color: #666666">3</span>)}
</pre></div>
<p>
The result is a table like the one above, except that the horizontal rules
and the heading are very short lines (but this is legal syntax -
it just does not look appealing in the DocOnce source).

<h3 id="___sec97">Generating the Entire Table in a Native Format via Mako <a name="___sec97"></a></h3>

<p>
To allow Sphinx and other formats, it is best to generate the entire
table. This can be done either by a Mako function or as a post
process after DocOnce has created the output file. We show the Mako
solution here.

<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Tip.</b>
A pure Python function Mako is easiest to develop in a seperate
Python program file because Python has better error messages
than Mako. Also, Python has debugging facilities that make the
development of the code much more efficient than writing in Mako.
When the Python function works, it can be inserted in the DocOnce
file inside the Mako directives <code>&lt;%</code> and <code>%&gt;</code>.
</div>


<p>
The Mako function for generating the entire table in LaTeX, HTML,
and Sphinx format goes as follows.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #666666">&lt;%</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">generate_native_table</span>(start, end, step, no_of_columns):
    text <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span>
    <span style="color: #408080; font-style: italic"># Heading</span>
    <span style="color: #008000; font-weight: bold">if</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;latex&quot;</span>, <span style="color: #BA2121">&quot;pdflatex&quot;</span>):
        text <span style="color: #666666">+=</span> <span style="color: #BA2121">r&quot;&quot;&quot;\begin{quote}\begin{tabular}{</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">}</span>
<span style="color: #BA2121">\hline</span>
<span style="color: #BA2121"> \\</span>
<span style="color: #BA2121">\hline</span>
<span style="color: #BA2121">&quot;&quot;&quot;</span> <span style="color: #666666">%</span> (<span style="color: #BA2121">&#39;c&#39;</span><span style="color: #666666">*</span>no_of_columns)
    <span style="color: #008000; font-weight: bold">elif</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;sphinx&quot;</span>, <span style="color: #BA2121">&quot;rst&quot;</span>, <span style="color: #BA2121">&quot;html&quot;</span>):
        text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;&lt;p&gt;&lt;table border=&quot;1&quot;&gt;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&lt;tr&gt;&#39;</span>
    fig_counter <span style="color: #666666">=</span> <span style="color: #666666">0</span>
    latex_columns <span style="color: #666666">=</span> []
    <span style="color: #008000; font-weight: bold">for</span> counter <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(start, end<span style="color: #666666">+1</span>, step):
        fig_counter <span style="color: #666666">+=</span> <span style="color: #666666">1</span>
        <span style="color: #008000; font-weight: bold">if</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;latex&quot;</span>, <span style="color: #BA2121">&quot;pdflatex&quot;</span>):
            latex_columns<span style="color: #666666">.</span>append(<span style="color: #BA2121">r&#39;\includegraphics[width=2cm]&#39;</span>\
                    <span style="color: #BA2121">&#39;{mov/wave_frames/frame_</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">.png}</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> counter)
        <span style="color: #008000; font-weight: bold">elif</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;sphinx&quot;</span>, <span style="color: #BA2121">&quot;rst&quot;</span>, <span style="color: #BA2121">&quot;html&quot;</span>):
            text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;&lt;td align=&quot;center&quot;&gt; &#39;</span>\
            <span style="color: #BA2121">&#39;&lt;a href=&quot;mov/wave_frames/frame_</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">.png&quot;&gt;&#39;</span>\
            <span style="color: #BA2121">&#39;&lt;img src=&quot;mov/wave_frames/frame_</span><span style="color: #BB6688; font-weight: bold">%04d</span><span style="color: #BA2121">.png&quot; width=&quot;300&quot;&gt;&#39;</span>\
            <span style="color: #BA2121">&#39;&lt;/a&gt; &lt;/td&gt;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (counter, counter)

        <span style="color: #008000; font-weight: bold">if</span> fig_counter <span style="color: #666666">%</span> no_of_columns <span style="color: #666666">==</span> <span style="color: #666666">0</span>:  <span style="color: #408080; font-style: italic"># new row</span>
            <span style="color: #008000; font-weight: bold">if</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;latex&quot;</span>, <span style="color: #BA2121">&quot;pdflatex&quot;</span>):
                text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;   &#39;</span> <span style="color: #666666">+</span> <span style="color: #BA2121">&#39; &amp; &#39;</span><span style="color: #666666">.</span>join(latex_columns)
                <span style="color: #008000; font-weight: bold">if</span> counter <span style="color: #666666">!=</span> end:
                    text <span style="color: #666666">+=</span> <span style="color: #BA2121">r&#39;</span><span style="color: #BB6622; font-weight: bold">\\</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
                latex_columns <span style="color: #666666">=</span> []
            <span style="color: #008000; font-weight: bold">elif</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;sphinx&quot;</span>, <span style="color: #BA2121">&quot;rst&quot;</span>, <span style="color: #BA2121">&quot;html&quot;</span>):
                text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;&lt;/tr&gt;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
                <span style="color: #008000; font-weight: bold">if</span> counter <span style="color: #666666">!=</span> end:
                    text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;&lt;tr&gt;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>  <span style="color: #408080; font-style: italic"># begin new row</span>
    <span style="color: #408080; font-style: italic"># Footer</span>
    <span style="color: #008000; font-weight: bold">if</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;latex&quot;</span>, <span style="color: #BA2121">&quot;pdflatex&quot;</span>):
        text <span style="color: #666666">+=</span> <span style="color: #BA2121">r&quot;&quot;&quot;\hline</span>
<span style="color: #BA2121">\end{tabular}\end{quote}</span>
<span style="color: #BA2121">&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">elif</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;sphinx&quot;</span>, <span style="color: #BA2121">&quot;rst&quot;</span>, <span style="color: #BA2121">&quot;html&quot;</span>):
        text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;&lt;/table&gt;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
    <span style="color: #008000; font-weight: bold">if</span> FORMAT <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">&quot;sphinx&quot;</span>, <span style="color: #BA2121">&quot;rst&quot;</span>):
        <span style="color: #408080; font-style: italic"># Wrap raw HTML code</span>
        lines <span style="color: #666666">=</span> text<span style="color: #666666">.</span>splitlines()
        text <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">.. raw:: html</span><span style="color: #BB6622; font-weight: bold">\n\n</span><span style="color: #BA2121">&#39;</span>
        <span style="color: #008000; font-weight: bold">for</span> line <span style="color: #AA22FF; font-weight: bold">in</span> lines:
            text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;    &#39;</span> <span style="color: #666666">+</span> line <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
        text <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
    <span style="color: #008000; font-weight: bold">return</span> text
<span style="color: #666666">%&gt;</span>

<span style="color: #408080; font-style: italic">## Example on call in DocOnce source</span>
${generate_native_table(<span style="color: #666666">80</span>, <span style="color: #666666">120</span>, <span style="color: #666666">5</span>, <span style="color: #666666">3</span>)}
</pre></div>
<p>
One can easily add support for various other formats, such as <code>pandoc</code>,
<code>gwiki</code>, <code>mwiki</code>, etc.
The output in format the current format is as above.

<h3 id="___sec98">Generating the Entire Table in a Native Format as a Post Process <a name="___sec98"></a></h3>

<p>
Instead of using Mako as shown above, we can invent our own syntax line
for the table with figures and apply a script to the DocOnce output file
to replace the special line with proper native code.
We use the same <code>generate_native_table</code> function as above, but this
time in a Python script. In the DocOnce source we place a line

<p>

<!-- code=doconce (!bc do) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">@@@FIGTABLE 80 120 5 3
</pre></div>
<p>
which is meant to generate a table with figures where the numbers
correspond to arguments in the <code>generative_native_table</code> function.

<p>
Suppose we have run

<p>

<!-- code=text (!bc sys) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">Terminal&gt; doconce format sphinx mydoc
</pre></div>
<p>
In the resulting <code>mydoc.rst</code> file we have the magic line <code>@@@FIGTABLE ...</code>.
Such lines can now be processed in our Python script:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># read mydoc.rst into the string filestr</span>
pattern <span style="color: #666666">=</span> <span style="color: #BA2121">r&#39;@@@FIGTABLE (.+)&#39;</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">replacement</span>(m):
    <span style="color: #408080; font-style: italic"># m is a MatchObject</span>
    args <span style="color: #666666">=</span> m<span style="color: #666666">.</span>group(<span style="color: #666666">1</span>)
    <span style="color: #408080; font-style: italic"># Convert args to a tuple of words with right type</span>
    args <span style="color: #666666">=</span> [<span style="color: #008000">eval</span>(arg) <span style="color: #008000; font-weight: bold">for</span> arg <span style="color: #AA22FF; font-weight: bold">in</span> args<span style="color: #666666">.</span>split()]
    text <span style="color: #666666">=</span> generate_native_table(<span style="color: #666666">*</span>args)

filestr <span style="color: #666666">=</span> re<span style="color: #666666">.</span>sub(pattern, filestr, replacement)
<span style="color: #408080; font-style: italic"># write filestr back to manual.rst</span>
</pre></div>
<p>
This code makes use of a function for creating the replacement string
for the <code>re.sub</code> command and demands a knowledge of regular expression
syntax and the workings or <code>re.sub</code>. A more plain Python version
goes like this:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #408080; font-style: italic"># read mydoc.rst into the string filestr</span>
lines <span style="color: #666666">=</span> filestr<span style="color: #666666">.</span>splitsplines()
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(lines)):
    <span style="color: #008000; font-weight: bold">if</span> lines[i]<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&#39;@@@FIGTABLE&#39;</span>):
        args <span style="color: #666666">=</span> lines[i][<span style="color: #666666">10</span>:]<span style="color: #666666">.</span>strip()
        <span style="color: #408080; font-style: italic"># Convert args to a tuple of words with right type</span>
        args <span style="color: #666666">=</span> [<span style="color: #008000">eval</span>(arg) <span style="color: #008000; font-weight: bold">for</span> arg <span style="color: #AA22FF; font-weight: bold">in</span> args<span style="color: #666666">.</span>split()]
        text <span style="color: #666666">=</span> generate_native_table(<span style="color: #666666">*</span>args)
        lines[i] <span style="color: #666666">=</span> text
filestr <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span><span style="color: #666666">.</span>join(lines)  <span style="color: #408080; font-style: italic"># make one string from all separate lines</span>
<span style="color: #408080; font-style: italic"># write filestr back to manual.rst</span>
</pre></div>
<p>
<div class="alert alert-block alert-success alert-text-normal"><b>Recommendation.</b>
This latter way of inserting specialized native text after DocOnce
has generated the output file is easier than using Mako and usually
also safer.
</div>


<p>
<div class="alert alert-block alert-warning alert-text-normal"><b>Lesson Learned.</b>
The above examples show different techniques for extending the
DocOnce capabilities. The ideas are not restricted to DocOnce: using
Mako as a preprocessing step or inserting &quot;magic&quot; lines that you
can later substitute by a script is possible in all types of
ASCII-based documents, e.g., LaTeX, Sphinx, and Markdown.
</div>


<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._manual024.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._manual026.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

