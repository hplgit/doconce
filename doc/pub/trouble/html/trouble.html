
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>DocOnce Troubleshooting and FAQ</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="DocOnce Troubleshooting and FAQ" href="index.html" />
    <link rel="prev" title="DocOnce Troubleshooting and FAQ" href="index.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="DocOnce Troubleshooting and FAQ"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">DocOnce Troubleshooting and FAQ</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="doconce-troubleshooting-and-faq">
<h1>DocOnce Troubleshooting and FAQ<a class="headerlink" href="#doconce-troubleshooting-and-faq" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">Hans Petter Langtangen</td>
</tr>
<tr class="field-even field"><th class="field-name">Date:</th><td class="field-body">Apr 8, 2016</td>
</tr>
</tbody>
</table>
<div class="admonition-disclaimer admonition">
<p class="first admonition-title">Disclaimer</p>
<p class="last">DocOnce has some support for syntax checking.  If you encounter Python
errors while running <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code>, the reason for the error is
most likely a syntax problem in your DocOnce source file. You have to
track down this syntax problem yourself. However, DocOnce applies
regular expressions to a large extent for transforming text, and
regular expressions may sometimes lead to undesired results.
Therefore, there is a chance that legal DocOnce syntax is not
treated properly. The section <a class="reference internal" href="#trouble-pitfalls"><span class="std std-ref">Examples on seemingly legal syntax that fails</span></a> gives some examples of what
can go wrong.</p>
</div>
<div class="section" id="general-topics">
<h2>General topics<a class="headerlink" href="#general-topics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-do-i-debug-a-doconce-file-that-results-in-a-strange-error-message">
<h3>How do I debug a DocOnce file that results in a strange error message?<a class="headerlink" href="#how-do-i-debug-a-doconce-file-that-results-in-a-strange-error-message" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-0"></span><p id="index-1">Isolate the problem by a &#8220;bisection&#8221; method: split the file in two, compile
both parts, continue with the part that gave the problem, and repeat
the process. This will quickly narrow down the text so you ultimately understand
the problem. If you do not understand why the identified piece of text
gives an error message, try to rewrite.</p>
</div>
<div class="section" id="how-do-i-cite-and-link-to-doconce">
<span id="sec-cite"></span><h3>How do I cite and link to DocOnce?<a class="headerlink" href="#how-do-i-cite-and-link-to-doconce" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-2"></span><p id="index-3">See the &#8220;How to cite&#8221; section
on the <a class="reference external" href="https://github.com/hplgit/doconce">project page</a>.</p>
</div>
<div class="section" id="translation-aborts-when-labels-are-not-defined">
<h3>Translation aborts when labels are not defined<a class="headerlink" href="#translation-aborts-when-labels-are-not-defined" title="Permalink to this headline">¶</a></h3>
<p>By default, the DocOnce translation aborts when references
are found to lables not defined in the document (i.e., labels in other
documents). This abortion can be annoying, and although it can be
nullified by <code class="docutils literal"><span class="pre">--no_abort</span></code>, that option also ignores other error messages.
Instead, use <code class="docutils literal"><span class="pre">--allow_refs_to_external_docs</span></code> to allow references to labels
in other documents (these references will of course not work).</p>
<p>References to labels in other documents should anyway appear inside
<em>generalized references</em>, see the <a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/manual/html/manual.html#generalized-xross-referencing">Generalied Cross-Referencing</a>
section in the manual.</p>
</div>
<div class="section" id="how-to-i-control-the-table-of-contents">
<span id="sec-toc-depth"></span><h3>How to I control the table of contents?<a class="headerlink" href="#how-to-i-control-the-table-of-contents" title="Permalink to this headline">¶</a></h3>
<p>To include a table of contents in the document, insert the line</p>
<div class="highlight-doconce"><div class="highlight"><pre><span class="gh">TOC:</span> on
</pre></div>
</div>
<p>in the DocOnce source at the place where you want the table of contents
to be inserted. Often you want to do a pagebreak before the table of
contents, and in that case, insert <code class="docutils literal"><span class="pre">!split</span></code> on the line before.</p>
<p>To control the number of section levels in the table of contents
(chapters, sections,
subsections), use the <code class="docutils literal"><span class="pre">--toc_depth=X</span></code> command-line option, where <code class="docutils literal"><span class="pre">X</span></code> reflects
the maximum level. Level 0 correspond to chapter. The defaul value of
<code class="docutils literal"><span class="pre">X</span></code>, 2, thus means including chapters, sections, and subsections.
For Sphinx output, one must use the command-line option <code class="docutils literal"><span class="pre">toc_depth=X</span></code>
as part of the command <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">sphinx_dir</span></code>.</p>
</div>
<div class="section" id="how-can-i-add-links-to-some-resource-on-every-page">
<span id="sec-custom-navlinks"></span><h3>How can I add links to some resource on every page?<a class="headerlink" href="#how-can-i-add-links-to-some-resource-on-every-page" title="Permalink to this headline">¶</a></h3>
<p>This question is most relevant for web documents. The simplest (and
actually the only feasible) solution is to use a style that has some
banner where links can be inserted.</p>
<div class="section" id="bootstrap-html-styles">
<h4>Bootstrap HTML styles<a class="headerlink" href="#bootstrap-html-styles" title="Permalink to this headline">¶</a></h4>
<p>All the Bootstrap styles have a navigation bar where one can insert
custom links with the <code class="docutils literal"><span class="pre">--html_bootstrap_navbar_links=</span></code> option.
Here is an example where we insert two links:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format html tmp1 --html_style=bootstrap \
          &quot;--html_bootstrap_navbar_links=\
          Google|http://google.com;\
          DocOnce formats|\
          http://hplgit.github.io/teamods/writing_reports/index.html&quot;
</pre></div>
</div>
<p>This command is broken over several lines but should be written on one
line. The syntax for custom links is <code class="docutils literal"><span class="pre">link|url;link|url;link|url</span></code>.
This example will result in a navigation bar with four links:
a link to the document using the title as text, a link to &#8220;Google&#8221;,
a link to &#8220;DocOnce formats&#8221;, and to the right a &#8220;Contents&#8221; pull-down
menu.</p>
</div>
<div class="section" id="vagrant-html-template">
<h4>Vagrant HTML template<a class="headerlink" href="#vagrant-html-template" title="Permalink to this headline">¶</a></h4>
<p>DocOnce comes with the <a class="reference external" href="https://github.com/hplgit/doconce/tree/master/bundled/html_styles/style_vagrant">Vagrant HTML template</a>,
which allows for custom links in the header (here is an <a class="reference external" href="http://hplgit.github.io/teamods/writing_reports/_static/report_vagrant.html">example on a
document</a>). Copy
the <code class="docutils literal"><span class="pre">template_vagrant.html</span></code> file and the <code class="docutils literal"><span class="pre">css</span></code> directory to the
directory containing the DocOnce document. Edit the <code class="docutils literal"><span class="pre">LogoWord</span></code> and
<code class="docutils literal"><span class="pre">withSubWord</span></code> in the <code class="docutils literal"><span class="pre">template_vagrant.html</span></code> and insert your own links
for <code class="docutils literal"><span class="pre">GO</span> <span class="pre">TO</span> <span class="pre">1</span></code> and <code class="docutils literal"><span class="pre">GO</span> <span class="pre">TO</span> <span class="pre">2</span></code>. Compile the document with</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format html mydoc --html_template=template_vagrant.html
</pre></div>
</div>
</div>
<div class="section" id="sphinx-bootstrap-theme">
<h4>Sphinx bootstrap theme<a class="headerlink" href="#sphinx-bootstrap-theme" title="Permalink to this headline">¶</a></h4>
<p>With the <code class="docutils literal"><span class="pre">bootstrap</span></code> theme, Sphinx can easily offer custom links.
You have to edit the generated <code class="docutils literal"><span class="pre">conf.py</span></code> in the Sphinx directory
(called <code class="docutils literal"><span class="pre">sphinx-rootdir</span></code> by default).
Search for <code class="docutils literal"><span class="pre">elif</span> <span class="pre">html_theme</span> <span class="pre">==</span> <span class="pre">'bootstrap</span></code> in this file and
edit the <code class="docutils literal"><span class="pre">navbar_links</span></code> item. Here is an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">elif</span> <span class="n">html_theme</span> <span class="o">==</span> <span class="s">&#39;bootstrap&#39;</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="n">html_theme_options</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;navbar_title&#39;</span><span class="p">:</span> <span class="n">short_title</span><span class="p">,</span>
        <span class="c"># Global TOC depth for &quot;site&quot; navbar tab. (Default: 1)</span>
        <span class="c"># Switching to -1 shows all levels.</span>
        <span class="s">&#39;globaltoc_depth&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="o">...</span>
        <span class="c"># A list of tuples containing pages or urls to link to.</span>
        <span class="o">...</span>
        <span class="s">&#39;navbar_links&#39;</span><span class="p">:</span> <span class="p">[</span>
           <span class="p">(</span><span class="s">&#39;Google&#39;</span><span class="p">,</span> <span class="s">&#39;http://google.com&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
           <span class="p">(</span><span class="s">&#39;DocOnce formats&#39;</span><span class="p">,</span>
            <span class="s">&#39;http://hplgit.github.io/teamods/writing_reports/index.html&#39;</span><span class="p">,</span>
            <span class="bp">True</span><span class="p">),</span>
           <span class="p">],</span>
</pre></div>
</div>
<p>One may hand-edit the <code class="docutils literal"><span class="pre">conf.py</span></code> file and provide a custom version
in the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">sphinx_dir</span></code> command:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce sphinx_dir conf.py=../customfiles/conf.py \
          theme=alabaster toc_depth=2 mydoc
</pre></div>
</div>
<p>Alternatively, one may auto edit the generated <code class="docutils literal"><span class="pre">conf.py</span></code> file in
a script:</p>
<div class="highlight-bash"><div class="highlight"><pre>doconce format sphinx mydoc
doconce sphinx_dir <span class="nv">theme</span><span class="o">=</span>alabaster <span class="nv">toc_depth</span><span class="o">=</span><span class="m">2</span> mydoc
<span class="c"># Auto edit conf.py</span>
doconce subst <span class="s2">&quot;#&#39;navbar_links&#39;:.+&quot;</span> <span class="s2">&quot;&#39;navbar_links&#39;: [</span>
<span class="s2">           (&#39;Google&#39;, &#39;http://google.com&#39;, True),</span>
<span class="s2">           (&#39;DocOnce formats&#39;,</span>
<span class="s2">            &#39;http://hplgit.github.io/teamods/writing_reports/index.html&#39;,</span>
<span class="s2">            True),</span>
<span class="s2">           ],&quot;</span> mydoc.rst
python automake_sphinx.py
</pre></div>
</div>
</div>
</div>
<div class="section" id="why-are-underscores-in-text-a-potential-problem">
<span id="sec-underscore"></span><h3>Why are underscores in text a potential problem?<a class="headerlink" href="#why-are-underscores-in-text-a-potential-problem" title="Permalink to this headline">¶</a></h3>
<p id="index-4">Underscores in plain text are not tolerated by LaTeX, but works fine in
other formats. In LaTeX, such underscores can give different obscure
error messages, depending on the context. The remedy is to <em>typeset all
words with underscores in inline verbatim</em>, e.g.,</p>
<div class="highlight-doconce"><div class="highlight"><pre>If you choose the `Enable_access` menu, ...
</pre></div>
</div>
<p>The downside is that the word with underscores is typeset in monospace font.</p>
<p>The standard remedy in LaTeX is to insert a backslash before the underscore:</p>
<div class="highlight-doconce"><div class="highlight"><pre>If you choose the Enable\_access menu, ...
</pre></div>
</div>
<p>but the backslash is not wanted in other formats. A Mako function can fix
this:</p>
<div class="highlight-doconce"><div class="highlight"><pre>&lt;%
def underscorephrase(phrase):
    if FORMAT in (&#39;pdflatex&#39;, &#39;latex&#39;):
        return phrase.replace(&#39;_&#39;, &#39;\\_&#39;)
    else:
        return phrase
%&gt;

<span class="c"># Some text:</span>
If you choose the ${underscorephrase(&#39;Enable_access&#39;)}, ...
</pre></div>
</div>
</div>
<div class="section" id="github-gh-pages-will-not-display-files-starting-with-a-dot-or-underscore">
<h3>GitHub gh-pages will not display files starting with a dot or underscore<a class="headerlink" href="#github-gh-pages-will-not-display-files-starting-with-a-dot-or-underscore" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-5"></span><p id="index-6">This is a typical problem related to publishing either splitted HTML documents
or Sphinx versions of documents on GitHub, using a gh-pages branch.
Filenames starting with a dot (as in <code class="docutils literal"><span class="pre">._mydoc001.html</span></code>) or located in
a directory whose name starts with an underscore (as in <code class="docutils literal"><span class="pre">spninx/_static</span></code>)
will not be properly shown in HTML if not the root directory of the
gh-pages branch contains a file <code class="docutils literal"><span class="pre">.nojekyll</span></code>. This file can be empty.
A typical fix is</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; git checkout gh-pages
Terminal&gt; touch .nojekyll
Terminal&gt; git add .nojekyll
Terminal&gt; git commit -am updates
Terminal&gt; git push origin gh-pages
</pre></div>
</div>
</div>
<div class="section" id="github-gh-pages-will-not-display-files">
<h3>GitHub gh-pages will not display files<a class="headerlink" href="#github-gh-pages-will-not-display-files" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-7"></span><p id="index-8">A common error is to link to addresses starting with <code class="docutils literal"><span class="pre">https://github.com</span></code>
rather than the required <code class="docutils literal"><span class="pre">http://username.github.io/</span></code>.</p>
</div>
<div class="section" id="blank-line-is-illegal-in-latex-block-but-there-is-no-blank-line">
<h3>&#8220;Blank line is illegal in latex block&#8221;, but there is no blank line<a class="headerlink" href="#blank-line-is-illegal-in-latex-block-but-there-is-no-blank-line" title="Permalink to this headline">¶</a></h3>
<p>Are you compiling for <code class="docutils literal"><span class="pre">sphinx</span></code>, <code class="docutils literal"><span class="pre">ipynb</span></code>, <code class="docutils literal"><span class="pre">pandoc</span></code>? In that case,
<code class="docutils literal"><span class="pre">align</span></code> environments are rewritten as sequences of plain <code class="docutils literal"><span class="pre">equation</span></code>
environments (since MathJax for these output formats does not support
numbered equations in <code class="docutils literal"><span class="pre">align</span></code>). If a linebreak <code class="docutils literal"><span class="pre">\\</span></code> in the <code class="docutils literal"><span class="pre">align</span></code>
environment appears on its own line, this line will be blank in the
equation environment and cause the error message. Simply move the
linebreak up at the end of the preceding line.</p>
<p><strong>Note:</strong>
This kind of errors are now automatically removed (since
Dec, 2015).</p>
</div>
<div class="section" id="a-newline-in-equations-double-backslash-becomes-single-backslash-and-eats-up-spaces">
<h3>A newline in equations (double backslash) becomes single backslash and eats up spaces<a class="headerlink" href="#a-newline-in-equations-double-backslash-becomes-single-backslash-and-eats-up-spaces" title="Permalink to this headline">¶</a></h3>
<p>This is a problem with the Mako preprocessor and files that have been
edited on Windows.  The remedy is to change the newline character on
Windows to that in Unix:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce subst &#39;\r\n&#39; &#39;\n&#39; mydoc.do.txt
</pre></div>
</div>
<p>If you work on Windows, you probably have to avoid using the Mako preprocessor
(it is not used unless you use Mako functions, variables, or control
statements).</p>
</div>
<div class="section" id="preprocess-error-unexpected-eof-while-parsing">
<h3>Preprocess error: unexpected EOF while parsing<a class="headerlink" href="#preprocess-error-unexpected-eof-while-parsing" title="Permalink to this headline">¶</a></h3>
<p>This error may arise from a syntax error with a colon at the end
of if tests, e.g. <code class="docutils literal"><span class="pre">#</span> <span class="pre">#if</span> <span class="pre">FORMAT</span> <span class="pre">==</span> <span class="pre">'html':</span></code>. Colon is not used
with Preprocess (but required by Mako: <code class="docutils literal"><span class="pre">if</span> <span class="pre">FORMAT</span> <span class="pre">==</span> <span class="pre">'html':</span></code>).</p>
</div>
<div class="section" id="when-i-set-a-large-portion-of-text-in-color-only-a-part-of-it-becomes-colored">
<h3>When I set a large portion of text in color, only a part of it becomes colored<a class="headerlink" href="#when-i-set-a-large-portion-of-text-in-color-only-a-part-of-it-becomes-colored" title="Permalink to this headline">¶</a></h3>
<p>Although DocOnce features a color inline tag (<code class="docutils literal"><span class="pre">color</span></code>),
this tag will most likely fail for large portions
of text. The reason is that this tag, like most other DocOnce
constructions, relies on a regular expression for being detected.
The regular expression searches for opening and closing braces after
the <code class="docutils literal"><span class="pre">color{red}</span></code> specification. The closing brace is the first brace
encountered. Therefore, if you have any text containing a right brace
inside the text to be colored, the first right brace will define the
end of the coloring. Here is an example:</p>
<div class="highlight-doconce"><div class="highlight"><pre>color{blue}{Here is some text
to be typeset in blue.

<span class="gh">===== Here is a new subsection =====</span>
<span class="nb">label{sec:subsec}</span>

More text to be typeset in blue, but the right brace in the label
will end the coloring. There is no way out of this except for
moving constructions with braces (`label`, `cite`) out of the
text to be colored.
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-make-use-of-a-native-latex-environments-example-environment-for-instance">
<span id="trouble-latex-envir-native"></span><h3>How can I make use of a native LaTeX environments (example environment for instance)?<a class="headerlink" href="#how-can-i-make-use-of-a-native-latex-environments-example-environment-for-instance" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-9"></span><span class="target" id="index-10"></span><p id="index-11">LaTeX writers often lack their favorite environments, but DocOnce has
a way to define such environments, with corresponding typesetting also
for HTML and all other output formats. See the section <a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/manual/html/manual.html#user-defined-environments">User-Defined
Environments</a>
in the DocOnce manual. It contains all the details for using a
standard example or theorem environment in LaTeX output.</p>
</div>
<div class="section" id="how-can-i-create-a-more-tailored-code-environment-in-latex-than-what-doconce-offers">
<h3>How can I create a more tailored code environment in LaTeX than what DocOnce offers?<a class="headerlink" href="#how-can-i-create-a-more-tailored-code-environment-in-latex-than-what-doconce-offers" title="Permalink to this headline">¶</a></h3>
<p>It is easy with <em>user-defined environments</em>, see
such an example at the end of the document
<a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/latexcode/demo.html">Demonstration of DocOnce support for LaTeX code block environments</a>.
Description of user-defined environments are found in
the <a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/manual/html/manual.html#user-defined-environments">DocOnce manual</a>.</p>
</div>
<div class="section" id="how-can-links-open-in-new-tabs-windows">
<h3>How can links open in new tabs/windows<a class="headerlink" href="#how-can-links-open-in-new-tabs-windows" title="Permalink to this headline">¶</a></h3>
<p id="index-12">Use the option <code class="docutils literal"><span class="pre">--html_links_in_new_window</span></code> for the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code>
command. It works in HTML and Sphinx, but not in pandoc (or other Markdown
formats) or wikis.</p>
</div>
<div class="section" id="movies-will-not-play-in-my-broswer">
<h3>Movies will not play in my broswer<a class="headerlink" href="#movies-will-not-play-in-my-broswer" title="Permalink to this headline">¶</a></h3>
<p id="index-13">Are you using Safari as browser? It will not play Ogg and WebM movies.
A message in a box should notify you about this (right below the movie
player).</p>
</div>
<div class="section" id="reveal-slides-look-strange-in-the-browser">
<h3>Reveal slides look strange in the browser<a class="headerlink" href="#reveal-slides-look-strange-in-the-browser" title="Permalink to this headline">¶</a></h3>
<p id="index-14">Are you using Safari as browser? reveal.js slides work best in
Firefox, Chrome, or Opera.</p>
</div>
<div class="section" id="how-can-i-control-the-vertical-spacing-in-slides">
<h3>How can I control the vertical spacing in slides?<a class="headerlink" href="#how-can-i-control-the-vertical-spacing-in-slides" title="Permalink to this headline">¶</a></h3>
<p id="index-15">HTML5 and LaTeX slides control the spacings for you. However, sometimes
you really want to add some space. The <code class="docutils literal"><span class="pre">&lt;linebreak&gt;</span></code> is effective for
this purpose. For example,</p>
<div class="highlight-doconce"><div class="highlight"><pre><span class="k">!bblock</span> (large) So - how to be excellent?
&lt;linebreak&gt;
Excellence is not a planned goal - it is the corollary of
deep passion, very much hard (and exciting!)
work, and *thinking constantly about it*.
<span class="k">!eblock</span>
</pre></div>
</div>
<p>is rendered as</p>
<div class="admonition-so-how-to-be-excellent admonition">
<p class="first admonition-title">So - how to be excellent</p>
<div class="line-block">
<div class="line">Excellence is not a planned goal - it is the corollary of</div>
</div>
<p class="last">deep passion, very much hard (and exciting!)
work, and <em>thinking constantly about it</em>.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">&lt;linebreak&gt;</span></code> is a newline in LaTeX if it has preceding text,
otherwise it is a <code class="docutils literal"><span class="pre">\vspace{3mm}</span></code>. In HTML, <code class="docutils literal"><span class="pre">&lt;linebreak&gt;</span></code> is <code class="docutils literal"><span class="pre">&lt;br&gt;</span></code>.</p>
<p>More vertical space is obtained by repeated use of <code class="docutils literal"><span class="pre">&lt;linebreak&gt;</span></code>:</p>
<div class="highlight-text"><div class="highlight"><pre>&lt;linebreak&gt;
&lt;linebreak&gt;
&lt;linebreak&gt;
</pre></div>
</div>
</div>
<div class="section" id="how-do-i-insert-a-copyright">
<span id="trouble-copyright"></span><h3>How do I insert a copyright?<a class="headerlink" href="#how-do-i-insert-a-copyright" title="Permalink to this headline">¶</a></h3>
<p id="index-16">See the <a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/manual/html/manual.html#copyright">Copyright section of the DocOnce manual</a>.</p>
<div class="section" id="other-formats">
<h4>Other formats<a class="headerlink" href="#other-formats" title="Permalink to this headline">¶</a></h4>
<p>An error message is provided.</p>
</div>
</div>
<div class="section" id="how-can-i-get-a-copyright-on-every-slide-page">
<h3>How can I get a copyright on every slide page?<a class="headerlink" href="#how-can-i-get-a-copyright-on-every-slide-page" title="Permalink to this headline">¶</a></h3>
<p id="index-17">HTML formats:
Use the <code class="docutils literal"><span class="pre">--copyright=everypage</span></code> option in the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">split_html</span></code> or
<code class="docutils literal"><span class="pre">doconce</span> <span class="pre">slides_html</span></code> commands.</p>
<p>LaTeX Beamer: The copyright is inserted as a <code class="docutils literal"><span class="pre">\logo{}</span></code> specification, but
this construction does not work in general. Then you cannot get the
copyright on every page. The copyright is inserted as part of the
date command so it is visible on the front page.</p>
<p>Recall that <code class="docutils literal"><span class="pre">{copyright...}</span></code> specification(s) must be part of the <code class="docutils literal"><span class="pre">AUTHOR:</span></code>
command in order to get any copyright notice at all.</p>
</div>
<div class="section" id="how-do-i-get-figure-written-in-another-language">
<span id="latex-custom-fig-name"></span><h3>How do I get &#8220;Figure&#8221; written in another language?<a class="headerlink" href="#how-do-i-get-figure-written-in-another-language" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-18"></span><span class="target" id="index-19"></span><p id="index-20">DocOnce documents can be written in any language, but figure captions
typically contain the English word &#8220;Figure&#8221;. This must be fixed
by auto-editing the output file after translation by <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code>.</p>
<p>In LaTeX you can use your native language package, e.g.,</p>
<div class="highlight-text"><div class="highlight"><pre>doconce replace &#39;% insert custom LaTeX commands...&#39; &#39;\\usepackage[norsk]{babel} mydoc.tex
</pre></div>
</div>
<p>to get the Norwegian language.</p>
<p>In other formats you have do more manual substitutions:</p>
<div class="highlight-text"><div class="highlight"><pre>doconce replace Figure Figur mydoc.html
doconce replace figure figur mydoc.html
</pre></div>
</div>
<p>or both in one command using regular expressions:</p>
<div class="highlight-text"><div class="highlight"><pre>doconce stubst &#39;([Ff]igur)e&#39; &#39;\g&lt;1&gt;&#39; mydoc.html
</pre></div>
</div>
</div>
<div class="section" id="spellcheck-reports-mistakes-that-i-cannot-find">
<h3>Spellcheck reports mistakes that I cannot find<a class="headerlink" href="#spellcheck-reports-mistakes-that-i-cannot-find" title="Permalink to this headline">¶</a></h3>
<p id="index-21">The <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">spellcheck</span></code> command strips off a lot of text
(math, code, syntax tags) before it starts spellchecking. The
spellchecked text is therefore different from the doconce source!
Fortunately, the file that is actually spellchecked can be examined.
If the spellcheck command is</p>
<div class="highlight-text"><div class="highlight"><pre>doconce spellcheck mydoc
</pre></div>
</div>
<p>the file <code class="docutils literal"><span class="pre">tmp_stripped_mydoc.do.txt</span></code> contains the text that is actually
run through the spellchecker (<code class="docutils literal"><span class="pre">ispell</span></code>). Search for the misspelled word there and
try to find it in the doconce source code. Very often, strange misspellings
come from a syntax typo that has led to a strange word in the stripped
version.</p>
<p>Wrong typesetting of mathematics can lead to strange errors, e.g.,
misspellings such as <code class="docutils literal"><span class="pre">iu</span></code> because of some math <code class="docutils literal"><span class="pre">f_iu_i</span></code> that is
not properly typeset between dollar signs. Here are some useful grep
commands to search for such errors:</p>
<div class="highlight-text"><div class="highlight"><pre>grep --color=auto -E &#39;\biu\b&#39; tmp_stripped_mydoc.do.txt
grep --color=auto -E &#39; iu&#39; tmp_stripped_mydoc.do.txt
grep --color=auto -E &#39;iu &#39; tmp_stripped_mydoc.do.txt
grep --color=auto -E &#39;iu&#39; tmp_stripped_mydoc.do.txt
</pre></div>
</div>
</div>
<div class="section" id="spellcheck-reports-a-lot-of-mistakes-related-to-latex-math">
<h3>Spellcheck reports a lot of mistakes related to LaTeX math<a class="headerlink" href="#spellcheck-reports-a-lot-of-mistakes-related-to-latex-math" title="Permalink to this headline">¶</a></h3>
<p id="index-22">The <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">spellcheck</span></code> command should ignore LaTeX math, but if
the dollar signs for inline math are not correct (one missing, for instance),
a lot of math enters the text to be spellchecked. Invoke the
relevant <code class="docutils literal"><span class="pre">tmp_missing_*</span></code> file and find the first math-style expression that
is reported as misspelling. Open the corresponding stripped file,
<code class="docutils literal"><span class="pre">tmp_stripped_*</span></code>, which is supposed to have all the math stripped
away, and search for the misspelling. When you find it, you will see
that there are math expressions in the stripped file that should not
be there. (Because of wrong begin and end signs around math expressions
ordinary text has instead been stripped away. This way, a missing dollar
sign can lead to hundreds of misspellings.)
Find the problem in the corresponding DocOnce file and correct it.
A similar error can be caused by wrong matching
of equation environments between <code class="docutils literal"><span class="pre">!bt</span></code> and <code class="docutils literal"><span class="pre">!et</span></code>.</p>
</div>
<div class="section" id="text-between-subexercises-are-moved">
<h3>Text between subexercises are moved<a class="headerlink" href="#text-between-subexercises-are-moved" title="Permalink to this headline">¶</a></h3>
<p id="index-23">If you insert text between a <code class="docutils literal"><span class="pre">!esubex</span></code> and the next <code class="docutils literal"><span class="pre">!bsubex</span></code>, this
text is moved before all the subexercises. This is a feature, not a
bug (exercises have certain elements: main text, subexercises, hints,
etc. that are typeset in a specific order, which may be different from
what appears in the DocOnce source file). If you need a comment
between two subexercises, just place the comment at the end of the
previous subexercise.</p>
</div>
<div class="section" id="doconce-aborts-because-of-a-syntax-error-that-is-not-an-error">
<h3>DocOnce aborts because of a syntax error that is not an error<a class="headerlink" href="#doconce-aborts-because-of-a-syntax-error-that-is-not-an-error" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-24"></span><p id="index-25">DocOnce searches for typical syntax errors and usually aborts the
execution if errors are found. However, it may happen,
especially in verbatim blocks, that DocOnce reports syntax errors
that are not errors. To continue execution, simply add the
<code class="docutils literal"><span class="pre">--no_abort</span></code> option on the command line. You may send an email
to the DocOnce author at <code class="docutils literal"><span class="pre">hpl&#64;simula.no</span></code> and report the problem.</p>
</div>
<div class="section" id="figure-captions-are-incomplete">
<h3>Figure captions are incomplete<a class="headerlink" href="#figure-captions-are-incomplete" title="Permalink to this headline">¶</a></h3>
<p id="index-26">If only the first part of a figure caption in the DocOnce file is seen
in the target output format, the reason is usually that the caption
occupies multiple lines in the DocOnce file. The figure caption must
be written as <em>one line</em>, at the same line as the FIGURE keyword.</p>
</div>
<div class="section" id="problems-with-boldface-and-emphasize">
<h3>Problems with boldface and emphasize<a class="headerlink" href="#problems-with-boldface-and-emphasize" title="Permalink to this headline">¶</a></h3>
<p>Two boldface or emphasize expressions after each other are not rendered
correctly. Merge them into one common expression.</p>
</div>
<div class="section" id="links-to-local-directories-do-not-work">
<h3>Links to local directories do not work<a class="headerlink" href="#links-to-local-directories-do-not-work" title="Permalink to this headline">¶</a></h3>
<p id="index-27">Links of the type</p>
<div class="highlight-text"><div class="highlight"><pre>see the &quot;examples directory&quot;: &quot;src/examples&quot;
</pre></div>
</div>
<p>do not work well. You need to link to a specific HTML file:</p>
<div class="highlight-text"><div class="highlight"><pre>see the &quot;examples directory&quot;: &quot;src/examples/index.html&quot;
</pre></div>
</div>
<p>We recommend to put all files you link to in a <code class="docutils literal"><span class="pre">_static</span></code> directory
if you intend to use the <code class="docutils literal"><span class="pre">sphinx</span></code> output. This guarantees that all
your files are collected in the Sphinx directory tree bundle.
With plain <code class="docutils literal"><span class="pre">html</span></code> output only, you can link to whatever, but remember
to move all files you link to if you move the primary <code class="docutils literal"><span class="pre">.html</span></code> file.</p>
</div>
<div class="section" id="links-are-not-typeset-correctly">
<h3>Links are not typeset correctly<a class="headerlink" href="#links-are-not-typeset-correctly" title="Permalink to this headline">¶</a></h3>
<p id="index-28">Not all formats will allow formatting of the links. Verbatim words
in links are allowed if the whole link is typeset in verbatim:</p>
<div class="highlight-text"><div class="highlight"><pre>see the directory &quot;`examples`&quot;: &quot;src/examples/index.html&quot;.
</pre></div>
</div>
<p>However, the following will not be typeset correctly:</p>
<div class="highlight-text"><div class="highlight"><pre>see the &quot;`examples`&quot;: &quot;src/examples/index.html&quot; directory.
</pre></div>
</div>
<p>The back-ticks must be removed, or the text can be reformulated as
in the line above it.</p>
</div>
<div class="section" id="inline-verbatim-code-or-boldface-is-not-detected-when-used-with-a-footnote">
<h3>Inline verbatim code or boldface is not detected when used with a footnote<a class="headerlink" href="#inline-verbatim-code-or-boldface-is-not-detected-when-used-with-a-footnote" title="Permalink to this headline">¶</a></h3>
<p id="index-29">There must be a space between the verbatim code (or boldface words)
and the footnote bracket:</p>
<div class="highlight-doconce"><div class="highlight"><pre>The construction `def f(x,y):`[^whitespace] is standard.

[^whitespace]: Well, a space before the `y` argument, as in `f(x, y)`,
would be the standard.
</pre></div>
</div>
</div>
<div class="section" id="inline-verbatim-code-is-not-detected">
<h3>Inline verbatim code is not detected<a class="headerlink" href="#inline-verbatim-code-is-not-detected" title="Permalink to this headline">¶</a></h3>
<p id="index-30">Make sure there is a space before the first back-tick.</p>
</div>
<div class="section" id="inline-verbatim-text-is-not-formatted-correctly">
<h3>Inline verbatim text is not formatted correctly<a class="headerlink" href="#inline-verbatim-text-is-not-formatted-correctly" title="Permalink to this headline">¶</a></h3>
<p id="index-31">Make sure there is whitespace surrounding the text in back-ticks.</p>
</div>
<div class="section" id="strange-non-english-characters">
<h3>Strange non-English characters<a class="headerlink" href="#strange-non-english-characters" title="Permalink to this headline">¶</a></h3>
<p id="index-32">The former reason for this problem is that DocOnce could only work with latin1
(ISO-8859) encoding and not UTF-8. After May 2013, DocOnce applies
UTF-8 both for HTML and LaTeX.</p>
<p>Check the encoding of the <code class="docutils literal"><span class="pre">.do.txt</span></code> file with the Unix <code class="docutils literal"><span class="pre">file</span></code> command
or with</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce guess_encoding myfile.do.txt
</pre></div>
</div>
<p>If the encoding is different from ASCII or UTF-8, say latin1, convert to UTF-8
using either of the Unix commands</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce change_encoding latin1 utf-8 myfile.do.txt
Terminal&gt; iconv -t utf-8 -f latin1 myfile.do.txt --output newfile
</pre></div>
</div>
</div>
<div class="section" id="wrong-norwegian-characters">
<h3>Wrong Norwegian characters<a class="headerlink" href="#wrong-norwegian-characters" title="Permalink to this headline">¶</a></h3>
<p id="index-33">When DocOnce documents have characters not in the standard ASCII set,
the format of the file must be UTF-8. See
the section &#8220;Strange non-English characters&#8221; above for how to
run <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">change_encoding</span></code> to change the encoding of the DocOnce file.</p>
</div>
<div class="section" id="too-short-underlining-of-rest-headlines">
<h3>Too short underlining of reST headlines<a class="headerlink" href="#too-short-underlining-of-rest-headlines" title="Permalink to this headline">¶</a></h3>
<p>This may happen if there is a paragraph heading without
proceeding text before some section heading.</p>
</div>
<div class="section" id="found-bt-but-no-tex-blocks-extracted-bug">
<h3>Found <code class="docutils literal"><span class="pre">!bt</span></code> but no tex blocks extracted (BUG)<a class="headerlink" href="#found-bt-but-no-tex-blocks-extracted-bug" title="Permalink to this headline">¶</a></h3>
<p>This message points to a bug, but has been resolved by removing blank lines
between the text and the first <code class="docutils literal"><span class="pre">!bt</span></code> (inserting the blanks again did not
trigger the error message again...).</p>
</div>
<div class="section" id="examples-are-typset-with-environment-delimiters-visible">
<h3>Examples are typset with environment delimiters visible<a class="headerlink" href="#examples-are-typset-with-environment-delimiters-visible" title="Permalink to this headline">¶</a></h3>
<p>If you see an Example section containing <code class="docutils literal"><span class="pre">!bsubex</span></code>, <code class="docutils literal"><span class="pre">!bsol</span></code>, or other
begin and end tags for environments, it means that you have intended
to typeset examples as exercises, but forgotten the command-line
option <code class="docutils literal"><span class="pre">--examples_as_exercises</span></code>. The text in the example is typeset
as is unless this option is included.</p>
</div>
<div class="section" id="emacs-editing-does-not-work-properly-because-of-regexp-overflow">
<h3>Emacs editing does not work properly because of &#8220;regexp overflow&#8221;<a class="headerlink" href="#emacs-editing-does-not-work-properly-because-of-regexp-overflow" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the Doonce editing mode (see the
<em>Emacs DocOnce Formatter</em> section in the manual) in Emacs
leads to an error message ending with &#8220;overflow in regexp matcher&#8221;.
This error is due to some regular expression used in the DocOnce editing
mode. The remedy is to split the file into smaller pieces and include
the pieces using the <code class="docutils literal"><span class="pre">preprocess</span></code> directive <code class="docutils literal"><span class="pre">#include</span> <span class="pre">&quot;piece.do.txt&quot;</span></code>.
The error message comes with the DocOnce file contains too much text
for Emacs to handle.</p>
</div>
<div class="section" id="my-machine-hangs-if-i-have-many-movies">
<h3>My machine hangs if I have many movies<a class="headerlink" href="#my-machine-hangs-if-i-have-many-movies" title="Permalink to this headline">¶</a></h3>
<p id="index-34">DocOnce has no limits on the amount of movies. When the output is
in HTML, one big HTML file may contain too many movies (local movie
files or embedded YouTube movies) for the browser to handle.
The remedy is to split the document into smaller pieces by inserting</p>
<div class="highlight-text"><div class="highlight"><pre>!split
</pre></div>
</div>
<p>for every new page. After <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">html</span> <span class="pre">mydoc</span></code>, run
<code class="docutils literal"><span class="pre">doconce</span> <span class="pre">split_html</span> <span class="pre">mydoc.html</span></code> to get the document split into
a main document <code class="docutils literal"><span class="pre">mydoc.html</span></code> and pieces <code class="docutils literal"><span class="pre">._mydocXXX.html</span></code>, where
<code class="docutils literal"><span class="pre">XXX</span></code> stands for three digits (<code class="docutils literal"><span class="pre">000</span></code>, <code class="docutils literal"><span class="pre">001</span></code>, <code class="docutils literal"><span class="pre">002</span></code>, and so forth).</p>
</div>
<div class="section" id="how-can-i-use-quotes-in-a-link">
<h3>How can I use quotes in a link?<a class="headerlink" href="#how-can-i-use-quotes-in-a-link" title="Permalink to this headline">¶</a></h3>
<p id="index-35">Links are typeset inside double quotes, but DocOnce applies double backticks
and double single quotes to typeset quotes, so the right form is</p>
<div class="highlight-text"><div class="highlight"><pre>&quot;This is a ``link text&#39;&#39; to google&quot;: &quot;http://google.com&quot;.
</pre></div>
</div>
<p>It appears as (typset in a <code class="docutils literal"><span class="pre">quote</span></code> admon):</p>
<blockquote>
<div>&#8220;This is a &#8220;link text` to google &lt;<a class="reference external" href="http://google.com">http://google.com</a>&gt;`__.</div></blockquote>
</div>
<div class="section" id="conversion-from-doconce-to-google-docs">
<h3>Conversion from DocOnce to Google Docs<a class="headerlink" href="#conversion-from-doconce-to-google-docs" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="convesion-from-google-docs-to-doconce">
<h3>Convesion from Google Docs to DocOnce<a class="headerlink" href="#convesion-from-google-docs-to-doconce" title="Permalink to this headline">¶</a></h3>
<p>This solution is not much explored and more text transformations from
Pandoc-generated Markdown is certainly needed.</p>
</div>
<div class="section" id="are-there-any-tools-for-shared-online-writing-of-doconce-documents">
<h3>Are there any tools for shared online writing of DocOnce documents?<a class="headerlink" href="#are-there-any-tools-for-shared-online-writing-of-doconce-documents" title="Permalink to this headline">¶</a></h3>
<p>In theory, <a class="reference external" href="http://draftin.com">http://draftin.com</a> and <a class="reference external" href="https://stackedit.io">https://stackedit.io</a>
can be used to share Markdown documents and these can be transform
to and from DocOnce documents. Tested to a little degree, but may
work for very simple documents (sections, lists, code - no labels, refs,
math, admons, code copied from file).
Not all of Extended Markdown is interpreted by DocOnce, and DocOnce
transforms to Panddoc-extended Markdown, not the Extended Markdown
used by these sites.</p>
</div>
<div class="section" id="examples-on-seemingly-legal-syntax-that-fails">
<span id="trouble-pitfalls"></span><h3>Examples on seemingly legal syntax that fails<a class="headerlink" href="#examples-on-seemingly-legal-syntax-that-fails" title="Permalink to this headline">¶</a></h3>
<p>Since DocOnce applies regular expressions to a large extent to translate
the input source to the output format, limitations of regular expressions
may lead to unexpected results. Here are some examples on what can go wrong.</p>
<div class="section" id="double-bold-italic">
<h4>Double bold/italic<a class="headerlink" href="#double-bold-italic" title="Permalink to this headline">¶</a></h4>
<p>Two strings with bold or emphasize after each other will not work:</p>
<div class="highlight-doconce"><div class="highlight"><pre><span class="c"># Not properly interpreted:</span>
Here is a _bold_ _word_.
<span class="c"># This is how to do it:</span>
Here is a _bold word_.

<span class="c"># Same with emphasize/italic:</span>
Cannot write *two emphasized* *words*,
but must write *two emphasized words*.
</pre></div>
</div>
<p>The wrong syntax implies that one of the texts inside
bold/italic tags will appear with DocOnce syntax in the output.</p>
</div>
<div class="section" id="mix-of-bold-italic-and-math">
<h4>Mix of bold/italic and math<a class="headerlink" href="#mix-of-bold-italic-and-math" title="Permalink to this headline">¶</a></h4>
<p>Trying to typeset a mixture of text and mathematics or code in boldface or
emphasized font fails:</p>
<div class="highlight-doconce"><div class="highlight"><pre>_It is important that $u_1=2$!_
*It is important that `a*b=b*a` in any computer language*.
</pre></div>
</div>
<p>The reason is that boldface or emphasize text cannot contain the
special characters dollar sign and backtick. However, if these
were allowed, the above examples would fail because the underscore
in <code class="docutils literal"><span class="pre">$u_1=2$</span></code> would mark the end of the boldface text. Similarly,
the <code class="docutils literal"><span class="pre">*</span></code> in <code class="docutils literal"><span class="pre">a*b</span></code> would mark the end of the emphasized text.
Such problems are avoided by <em>only using plain text inside
emphasize or boldface tags</em>:</p>
<div class="highlight-doconce"><div class="highlight"><pre>_It is important that_ $u_1=2$!
*It is important that* `a*b=b*a` *in any computer language*.
</pre></div>
</div>
<p>Another similar example is the mix of <code class="docutils literal"><span class="pre">**text**</span></code> syntax
with braces inside the text. For example,</p>
<div class="highlight-doconce"><div class="highlight"><pre>color{blue}{However, here a blue color specification
fails: $\frac{1}{2}\omega^2$.}
</pre></div>
</div>
<p>The text part is interpreted as string with <code class="docutils literal"><span class="pre">However</span></code> and lasting up
to the first right brace, which is in <code class="docutils literal"><span class="pre">\frac{1}</span></code>. A remedy is, as above,
to only use plain text inside the text part of the color specification
and use a <code class="docutils literal"><span class="pre">\textcolor</span></code> command inside the mathematics:</p>
<div class="highlight-doconce"><div class="highlight"><pre>color{blue}{However, here a blue color specification
fails:} $\textcolor{red}{\frac{1}{2}\omega^2}$.}
</pre></div>
</div>
<p>Mathematics and code in blocks are invisible when inline tagging is
interpreted and translated. Therefore, a specification as follows
works well:</p>
<div class="highlight-doconce"><div class="highlight"><pre>color{red}{This equation,

<span class="k">!bt</span>
<span class="nb">\begin{equation}</span>
a = b
<span class="nb">label{eq1}</span>
<span class="nb">\end{equation}</span>
<span class="k">!et</span>
is meant to be in red and it works.}
</pre></div>
</div>
<p>The rules are that <code class="docutils literal"><span class="pre">*text*</span></code>, <code class="docutils literal"><span class="pre">_text_</span></code>, and <code class="docutils literal"><span class="pre">**text**</span></code>
employs a simple rule: <code class="docutils literal"><span class="pre">text</span></code> lasts up to the first end-tag
character (<code class="docutils literal"><span class="pre">*</span></code>, <code class="docutils literal"><span class="pre">_</span></code>, and <code class="docutils literal"><span class="pre">}</span></code> above), but code and math blocks
do not count.</p>
</div>
</div>
<div class="section" id="how-can-i-make-pressbooks-com-books-from-doconce">
<h3>How can I make pressbooks.com books from DocOnce?<a class="headerlink" href="#how-can-i-make-pressbooks-com-books-from-doconce" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://pressbooks.com">http://pressbooks.com</a> supports HTML input with WordPress LaTeX mathematics,
so the easiest way is to compile DocOnce to HTML with the <code class="docutils literal"><span class="pre">--wordpress</span></code>
option, put the file on the web somewhere, click <em>Utilities - Import</em>
in pressbooks.com, then choose HTML input, write the URL, and upload.</p>
<p>Note that WordPress LaTeX cannot refer to equations using labels!
This is a major problem with pressbooks.com.</p>
</div>
<div class="section" id="how-can-i-produce-epub-books-from-doconce">
<span id="trouble-epub"></span><h3>How can I produce ePub books from DocOnce?<a class="headerlink" href="#how-can-i-produce-epub-books-from-doconce" title="Permalink to this headline">¶</a></h3>
<p id="index-36">DocOnce has no direct translation to ePub, but one can apply a script
<a class="reference external" href="https://github.com/hplgit/ebookmaker">ebookmaker.py</a> to translate
a set of split HTML files to ePub. Bootstrap styles with mathematics
and code come out very nice in ePub this way.
The script needs a JSON file. If <code class="docutils literal"><span class="pre">mydoc.do.txt</span></code> is the DocOnce file
and <code class="docutils literal"><span class="pre">._mydoc*.html</span></code> the set of split HTML files after translation
to HTML, the JSON file may look like this:</p>
<div class="highlight-text"><div class="highlight"><pre>{
    &quot;filename&quot; : &quot;mydoc&quot;,
    &quot;title&quot; : &quot;Title of the document&quot;,
    &quot;authors&quot; : [
        {
            &quot;name&quot; : &quot;Hans Petter Langtangen&quot;,
            &quot;sort&quot; : &quot;Langtangen, Hans Petter&quot;
        }
    ],
    &quot;rights&quot; : &quot;Public Domain&quot;,
    &quot;language&quot; : &quot;en&quot;,
    &quot;publisher&quot;: &quot;hpl&quot;,
    &quot;subjects&quot; : [ &quot;Science&quot; ],
    &quot;contributors&quot; : [
        {
            &quot;name&quot; : &quot;Hans Petter Langtangen&quot;,
            &quot;role&quot; : &quot;author&quot;
        }
    ],
    &quot;identifier&quot; : {
        &quot;scheme&quot; : &quot;URL&quot;,
        &quot;value&quot; : &quot;http://somewhere.net&quot;
    },
    &quot;contents&quot; : [
        {
            &quot;type&quot; : &quot;text&quot;,
            &quot;source&quot; : &quot;._mydoc*.html&quot;
        }
    ],
    &quot;toc&quot; : {
        &quot;depth&quot; : 2,
        &quot;parse&quot; : [ &quot;text&quot; ],
        &quot;generate&quot; : {
            &quot;title&quot; : &quot;Index&quot;
        }
    }
}
</pre></div>
</div>
<p>Just edit this file to your needs, save it as <code class="docutils literal"><span class="pre">mydoc.json</span></code> and run
<code class="docutils literal"><span class="pre">epubmaker.py</span> <span class="pre">mydoc.json</span></code> to produce <code class="docutils literal"><span class="pre">mydoc.epub</span></code>.
Read in <a class="reference external" href="http://calibre-ebook.com/">Calibre</a>
on computers or use ebook readers on phones and tablets.</p>
</div>
<div class="section" id="what-about-non-english-languages-and-doconce">
<span id="trouble-non-english"></span><h3>What about non-English languages and DocOnce?<a class="headerlink" href="#what-about-non-english-languages-and-doconce" title="Permalink to this headline">¶</a></h3>
<p id="index-37">DocOnce can handle non-English language, although most of its use has
concerned documents in English. When writing in languages with
non-ASCII characters, remember to use the command-line option
<code class="docutils literal"><span class="pre">--encoding=utf-8</span></code>.
Some other points of importance:</p>
<blockquote>
<div><ul class="simple">
<li>The abstract requires a heading Summary or Abstract. This heading
must be substitued by the appropriate word after translation.</li>
<li>LaTeX files should make use of packages and options for the language
in question such that LaTeX-generated headings get the right
language-specific wording.
Use <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code> or <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">search</span></code> modify the
<code class="docutils literal"><span class="pre">.tex</span></code> file (see the Bash script referred to below for examples).</li>
<li>Some DocOnce-generated headings are in English, e.g.,
&#8220;Table of Contents&#8221;, which must be edited by <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code>.</li>
<li>For Sphinx output, two edits in files in the Sphinx root directory
(<code class="docutils literal"><span class="pre">sphinx-rootdir</span></code> by default) are necessary (see Bash script below for
examples on autoediting):<ul>
<li>Insert right language in <code class="docutils literal"><span class="pre">conf.py</span></code>: <code class="docutils literal"><span class="pre">language</span> <span class="pre">=</span> <span class="pre">'nb_NO'</span></code> for Norwegian</li>
<li>Edit headings in <code class="docutils literal"><span class="pre">index.rst</span></code>: &#8220;Contents:&#8221; and
&#8220;Tables and indices&#8221;, to what the language demands</li>
<li>Unfortunately, &#8220;Page contents&#8221;, &#8220;Next page&#8221;, and
&#8220;Previous page&#8221; remains in English
in the navigation area (these can, of course, be replaced in all
the HTML files generated by Sphinx in <code class="docutils literal"><span class="pre">_build/html</span></code> - recall to edit
also all the files starting with a dot if you have split the document
(<code class="docutils literal"><span class="pre">doconce</span> <span class="pre">split_rst</span></code>))</li>
</ul>
</li>
</ul>
</div></blockquote>
<p>There is an example of a document in Norwegian in the DocOnce repository
where we do all necessary adjustments mentioned above:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/hplgit/doconce/blob/master/doc/src/locale/Norwegian.do.txt">DocOnce source</a></li>
<li><a class="reference external" href="https://github.com/hplgit/doconce/blob/master/doc/src/locale/make.sh">Bash script for compiling the DocOnce source</a></li>
<li><a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/locale/Norwegian.pdf">PDF</a></li>
<li><a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/locale/Norwegian.html">HTML</a></li>
<li><a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/locale/sphinx/index.html">Sphinx</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="lists-look-wrong">
<h3>Lists look wrong<a class="headerlink" href="#lists-look-wrong" title="Permalink to this headline">¶</a></h3>
<p id="index-38">It is very important to be accurate with white space in lists.
There must be exactly <em>one blank</em> between the <code class="docutils literal"><span class="pre">o</span></code> or <code class="docutils literal"><span class="pre">*</span></code> that
starts an item and the following text, and multiple lines in an
item must be perfectly aligned. Here are some typical errors:</p>
<div class="highlight-doconce"><div class="highlight"><pre>o a rectangular pulse
o  a Gaussian pulse
o one period of a cosine pulse
o half a period of
 a cosine pulse
</pre></div>
</div>
<p>Problem: <code class="docutils literal"><span class="pre">a</span> <span class="pre">Gaussian</span> <span class="pre">pulse</span></code> is not properly aligned, <code class="docutils literal"><span class="pre">a</span> <span class="pre">cosine</span> <span class="pre">pulse</span></code> on
the last line is not properly aligned. The correct formatting is</p>
<div class="highlight-doconce"><div class="highlight"><pre>o a rectangular pulse
o a Gaussian pulse
o one period of a cosine pulse
o half a period of
  a cosine pulse
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-get-an-overview-of-all-files-that-are-included-in-a-document">
<h3>How can I get an overview of all files that are included in a document?<a class="headerlink" href="#how-can-i-get-an-overview-of-all-files-that-are-included-in-a-document" title="Permalink to this headline">¶</a></h3>
<p>Suppose the root (main) document is <code class="docutils literal"><span class="pre">mydoc.do.txt</span></code>. Run</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce include_map mydoc.do.txt
</pre></div>
</div>
<p>The output lists all the recursive <code class="docutils literal"><span class="pre">#include</span></code> Preprocess statements so you
can see how all files are included.</p>
</div>
<div class="section" id="how-to-write-the-dollar-sign-for-an-amount-in-dollars">
<h3>How to write the dollar sign for an amount in dollars?<a class="headerlink" href="#how-to-write-the-dollar-sign-for-an-amount-in-dollars" title="Permalink to this headline">¶</a></h3>
<p>If you want to write <code class="docutils literal"><span class="pre">$1,000</span></code>, this is not trivial, because the dollar
sign is used for inline math formulas, and everything from this dollar sign
up to the next is interpreted as a math formula.</p>
<p>The solution in DocOnce is to prefix the dollar sign by a backslash (same
syntax as required by LaTeX).
This ensures correct output in all output formats.</p>
<p>Another solution is to pre- or postfix the amount by USD instead of the
dollar sign.</p>
</div>
<div class="section" id="problems-with-externaldocuments-specifications">
<span id="trouble-externaldocuments"></span><h3>Problems with Externaldocuments specifications<a class="headerlink" href="#problems-with-externaldocuments-specifications" title="Permalink to this headline">¶</a></h3>
<p id="index-39">The <code class="docutils literal"><span class="pre">#</span> <span class="pre">Externaldocuments:</span></code> command is used for <em>generalized
references</em> to lables in other documents. The command specifies
directories with <code class="docutils literal"><span class="pre">.aux</span></code> files and provides the necessary information
for using <code class="docutils literal"><span class="pre">xr</span></code> package for external references in case of LaTeX
output. For all other formts an alternative user-given text is used
and <code class="docutils literal"><span class="pre">#</span> <span class="pre">Externaldocuments:</span></code> has no effect.  A typical use case is that
one book refers to another book.  This may cause trouble when the
<code class="docutils literal"><span class="pre">.tex</span></code> and <code class="docutils literal"><span class="pre">.aux</span></code> files specified in the <code class="docutils literal"><span class="pre">#</span> <span class="pre">Externaldocuments:</span></code>
command do not exist. A quick fix is to follow the advice in the error
message and use the <code class="docutils literal"><span class="pre">touch</span></code> command to create empty files so DocOnce
does not abort the execution. However, the only real fix is to install
all the directory trees specified in the <code class="docutils literal"><span class="pre">#</span> <span class="pre">Externaldocuments:</span></code>
command.</p>
<p>References to such external documents may also cause trouble when
sending the <code class="docutils literal"><span class="pre">.tex</span></code> files for a book to a publisher, since the
<code class="docutils literal"><span class="pre">\externaldocument{}</span></code> commands in the <code class="docutils literal"><span class="pre">.tex</span></code> file
in this file will refer to <code class="docutils literal"><span class="pre">.aux</span></code>
files in other directories (which the publisher then must have).
A good fix to this problem is provided by the sample packing
script <a class="reference external" href="https://github.com/hplgit/setup4book-doconce/blob/master/doc/src/book/pack_Springer.sh">pack_Springer.sh</a>,
which calls up another script <a class="reference external" href="https://github.com/hplgit/setup4book-doconce/blob/master/doc/src/book/grab_stylefiles.py">grab_stylefiles.py</a>,
which automatically copies the <code class="docutils literal"><span class="pre">.aux</span></code> files in question to a subdirectory and
autoedits the main <code class="docutils literal"><span class="pre">.tex</span></code> for the DocOnce document accordingly. The
purpose of <code class="docutils literal"><span class="pre">pack_Springer.sh</span></code> is to make a directory tree with all
files (including stylefiles) needed to compile a LaTeX version of the
document. This tree can then be sent to the publisher and is self contained.</p>
<p>Another fix for problems with the <code class="docutils literal"><span class="pre">#</span> <span class="pre">Externaldocuments:</span></code> command is to
hardcode references when files needs to be sent to a publisher. Typically,
one has</p>
<div class="highlight-doconce"><div class="highlight"><pre>% if not FOR_PUBLISHER:
<span class="c"># Externaldocuments: ../../some/path, ../some/other/path</span>
% endif
</pre></div>
</div>
<p>Every generalized reference to a label in the specified external
documents must have a special case when files are meant
for a publisher:</p>
<div class="highlight-doconce"><div class="highlight"><pre>% if FOR_PUBLISHER
ref[Section 4.2][ in
% else:
ref[Section ref{my:label}][ in
%endif
cite {book}][the section ``Guidelines&#39;&#39; in the document
<span class="s">&quot;A note on everything&quot;</span>: &quot;http://...&quot;].
</pre></div>
</div>
<p>Setting <code class="docutils literal"><span class="pre">FOR_PUBLISHER=True</span></code> as part of the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">pdflatex</span></code>
command will then effectively remove everything with the
<code class="docutils literal"><span class="pre">#</span> <span class="pre">Externaldocuments:</span></code> command and generalized references.</p>
</div>
<div class="section" id="what-is-the-difference-between-doconce-replace-and-doconce-subst">
<h3>What is the difference between doconce replace and doconce subst?<a class="headerlink" href="#what-is-the-difference-between-doconce-replace-and-doconce-subst" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code> replaces one text by another, exactly as the text is
written. For example, <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span> <span class="pre">float</span> <span class="pre">double</span> <span class="pre">*.do.txt</span></code> is the same as
invoking an editor and replacing <code class="docutils literal"><span class="pre">float</span></code> by <code class="docutils literal"><span class="pre">double</span></code> in all files <code class="docutils literal"><span class="pre">*.do.txt</span></code>.
On the other hand, <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span></code> works with <em>regular expressions</em>, so
<code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span> <span class="pre">from</span> <span class="pre">to</span></code> is the same as <code class="docutils literal"><span class="pre">re.sub(from,</span> <span class="pre">to)</span></code> in Python.
You need experience with <code class="docutils literal"><span class="pre">re.sub</span></code> and regular expressions to take advantage
of <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span></code>.
Regular expressions are much more powerful for editing text, but also
more complicated and errorprone.</p>
</div>
</div>
<div class="section" id="preprocess-mako">
<h2>Preprocess/Mako<a class="headerlink" href="#preprocess-mako" title="Permalink to this headline">¶</a></h2>
<div class="section" id="list-important-things-to-remember-when-programming-mako">
<h3>List important things to remember when programming Mako<a class="headerlink" href="#list-important-things-to-remember-when-programming-mako" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="the-mako-preprocessor-is-fooled-by-doconce-text">
<h3>The Mako preprocessor is fooled by DocOnce text<a class="headerlink" href="#the-mako-preprocessor-is-fooled-by-doconce-text" title="Permalink to this headline">¶</a></h3>
<p>Here are possible problems for Mako:</p>
<blockquote>
<div><ul class="simple">
<li>Strings with <code class="docutils literal"><span class="pre">'T&lt;%.1f'</span></code> look as openings of Mako blocks (<code class="docutils literal"><span class="pre">&lt;%</span></code>); change
to <code class="docutils literal"><span class="pre">'T</span> <span class="pre">&lt;</span> <span class="pre">%.1f'</span></code> to avoid this confusion.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="the-mako-preprocessor-has-problems-with-lines-starting-with-percent-sign">
<h3>The Mako preprocessor has problems with lines starting with percent sign<a class="headerlink" href="#the-mako-preprocessor-has-problems-with-lines-starting-with-percent-sign" title="Permalink to this headline">¶</a></h3>
<p id="index-40">If you have lines starting with <code class="docutils literal"><span class="pre">%</span></code> inside code segments (for example,
SWIG code or Matlab comment lines), the Mako preprocessor will crash
because it thinks these lines are Mako statements. DocOnce detects
this problem and emits an error message. The solution to
this problem is to replace a single <code class="docutils literal"><span class="pre">%</span></code> at the <em>very</em> beginning of the line
(column 1) inside code by a double <code class="docutils literal"><span class="pre">%%</span></code>. Mako will replace it by a single <code class="docutils literal"><span class="pre">%</span></code>.
However, contrary to what is claimed in the Mako documentation,
an indented double <code class="docutils literal"><span class="pre">%%</span></code> remains <code class="docutils literal"><span class="pre">%%</span></code> and is not converted to <code class="docutils literal"><span class="pre">%</span></code> (and
using a single <code class="docutils literal"><span class="pre">%</span></code> gives a Mako error). The trick is to write <code class="docutils literal"><span class="pre">${'%'}</span></code>
as demonstrated here:</p>
<div class="highlight-text"><div class="highlight"><pre>!bc mcod
%% Comment on the beginning of the line can be escaped by %%
if a &gt; b
  ${&#39;%&#39;} Indented comment needs this trick
  c = a + b
end
!ec
</pre></div>
</div>
</div>
<div class="section" id="the-mako-preprocessor-gives-syntax-error-in-python-code">
<h3>The Mako preprocessor gives syntax error in Python code<a class="headerlink" href="#the-mako-preprocessor-gives-syntax-error-in-python-code" title="Permalink to this headline">¶</a></h3>
<p id="index-41">The information with respect to syntax errors in Python code is
sparse. It is recommended to move the Python code to separate files
and test it with the ordinary Python interpreter. See the
section <em>Debugging Python code in Mako</em> in the DocOnce manual.</p>
</div>
<div class="section" id="the-mako-preprocessor-gives-strange-error-messages">
<h3>The Mako preprocessor gives strange error messages<a class="headerlink" href="#the-mako-preprocessor-gives-strange-error-messages" title="Permalink to this headline">¶</a></h3>
<p id="index-42">If you to a little syntax error in Mako, the consequences can be
quite unpredictable. Especially, if you forget curly braces around
variables or function calls, the forthcoming text is processed as
part of the Mako command. Pay attention to the line number reported
by Mako: this is the line number after Preprocess has processed
the DocOnce document, so you need to load <code class="docutils literal"><span class="pre">tmp_preprocess__mydoc.do.txt</span></code>
and go to the right line in that file to see the Mako problem
(here the DocOnce document is named <code class="docutils literal"><span class="pre">mydoc.do.txt</span></code>).</p>
<p>Look through the specific Mako problems
reported below, and if they do not bring you to a solution of
the problem, search for all occurences of dollar, left curly brace
and check the syntax carefully. Likewise, check the syntax of
Mako if-tests.</p>
<p>Another widely used technique is to copy out small parts of
the complete document to a separate file and run <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code>.
In this way you can easier see which parts of the document that
work and where the error suddenly appears.</p>
<div class="admonition-tip-compile-your-doconce-document-frequently admonition">
<p class="first admonition-title">Tip: Compile your DocOnce document frequently</p>
<p class="last">The best means against Mako problems is to run <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code>
often. Combined Git, you can take
a <code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code> to see what you have recently changed and get an idea
what can be wrong.</p>
</div>
</div>
<div class="section" id="the-mako-preprocessor-claims-a-variable-is-undefined">
<h3>The Mako preprocessor claims a variable is undefined<a class="headerlink" href="#the-mako-preprocessor-claims-a-variable-is-undefined" title="Permalink to this headline">¶</a></h3>
<p id="index-43">Very often such errors are related to typos when using Mako
variables or functions, or correct yet undesired LaTeX syntax.
For example,</p>
<div class="highlight-doconce"><div class="highlight"><pre>${\cal O}(\Delta x^2)$
</pre></div>
</div>
<p>is valid LaTeX, but
the dollar sign and curly braces confuse Mako. Rewrite such
mathematics. It is wise to not use <code class="docutils literal"><span class="pre">${</span></code> anywhere in LaTeX mathematics.
Create a newcommand if there are no other possible rewritings.
A known common problem is <code class="docutils literal"><span class="pre">${}^+$</span></code> type of indication of superscripts.
A suggested rewrite is <code class="docutils literal"><span class="pre">$\,{}^+$</span></code>.</p>
<p>The error message will ask you to rerun <code class="docutils literal"><span class="pre">doconce</span></code> with
<code class="docutils literal"><span class="pre">--mako_strict_undefined</span></code>, which will display the variable that is
confusing Mako. Sometimes the variable is printed, sometimes a totally
different name is said to be undefined. This is confusing, because
then you have to use the bisection method below to narrow down the
problem yourself.</p>
<p>Do not continue to use <code class="docutils literal"><span class="pre">--mako_strict_undefined</span></code> while you are
debugging because this variable or a new variable will then always be
undefined in that mode.  Rerun without <code class="docutils literal"><span class="pre">--mako_strict_undefined</span></code> to
see if the problem is gone. If not, try the option again, and if no
progress, use <code class="docutils literal"><span class="pre">#</span> <span class="pre">#ifdef</span></code> directives to comment out large portions of
the text and apply a bisection procedure to locate where the Mako
problem is (without <code class="docutils literal"><span class="pre">--mako_strict_undefined</span></code>).  A bisection procedure
means that you comment out the last half, find in which half the
problem is, comment out half of that half, find in which half the
problem is, and so on. The procedure converges pretty quickly, even
for large books.</p>
</div>
<div class="section" id="something-goes-wrong-in-the-preprocessing-step">
<h3>Something goes wrong in the preprocessing step<a class="headerlink" href="#something-goes-wrong-in-the-preprocessing-step" title="Permalink to this headline">¶</a></h3>
<p id="index-44">You can examine <code class="docutils literal"><span class="pre">tmp_preprocess__filename</span></code> and <code class="docutils literal"><span class="pre">tmp_mako__filename</span></code>,
where <code class="docutils literal"><span class="pre">filename</span></code> is the complete name of the DocOnce file, to see
what the preprocessors actually to and if something is wrong in these
files before DocOnce starts translating the text.
One or both of those files may be missing, but examine the beginning
of the output from DocOnce to see exactly which preprocessors are run
and on which files.</p>
</div>
<div class="section" id="preprocessor-directives-do-not-work">
<h3>Preprocessor directives do not work<a class="headerlink" href="#preprocessor-directives-do-not-work" title="Permalink to this headline">¶</a></h3>
<p>Make sure the preprocessor instructions, in Preprocess or Mako, have
correct syntax. Also make sure that you do not mix Preprocess and Mako
instructions. DocOnce will then only run Preprocess.</p>
</div>
</div>
<div class="section" id="code-or-tex-blocks">
<h2>Code or Tex Blocks<a class="headerlink" href="#code-or-tex-blocks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="too-long-lines-in-math-blocks">
<h3>Too long lines in math blocks<a class="headerlink" href="#too-long-lines-in-math-blocks" title="Permalink to this headline">¶</a></h3>
<p>A common problem in LaTeX (not directly related to DocOnce) is too long lines
in math blocks. The trick is to use the <code class="docutils literal"><span class="pre">align</span></code> or <code class="docutils literal"><span class="pre">align*</span></code> environment
and introduce newlines with <code class="docutils literal"><span class="pre">\nonumber\\</span></code> to break up lines (without introducing
an equation number). Typically,</p>
<ol class="arabic simple">
<li>Insert <code class="docutils literal"><span class="pre">\nonumber\\</span></code> where you see a linebreak should occur.</li>
<li>Start next line with <code class="docutils literal"><span class="pre">&amp;\quad</span></code> such that the continuing line starts slightly to the right of the alignment character used to align the equations. If you have only one equation, find some point where you insert <code class="docutils literal"><span class="pre">&amp;</span></code> and just start the next line with <code class="docutils literal"><span class="pre">&amp;</span></code> - no <code class="docutils literal"><span class="pre">\quad</span></code> displacement to the right is needed in that case.</li>
<li><code class="docutils literal"><span class="pre">\left(</span></code> and <code class="docutils literal"><span class="pre">\right)</span></code> (and similar constructions for automatic adjustment of the sizes of parentheses) do not work accross linebreaks. This means that you must replace <code class="docutils literal"><span class="pre">\left(</span></code> by (e.g.) <code class="docutils literal"><span class="pre">\biggl(</span></code> unless there is a corresponding <code class="docutils literal"><span class="pre">\right</span></code> on the same line. Whether to choose <code class="docutils literal"><span class="pre">\biggl</span></code>, <code class="docutils literal"><span class="pre">\bigl</span></code>, or <code class="docutils literal"><span class="pre">\Biggl</span></code> depends on the desired size of the the parenthesis.</li>
</ol>
</div>
<div class="section" id="code-or-math-block-errors-in-rest">
<h3>Code or math block errors in reST<a class="headerlink" href="#code-or-math-block-errors-in-rest" title="Permalink to this headline">¶</a></h3>
<p>First note that a code or math block must come after some plain
sentence (at least for successful output in reST), not directly
after a section/paragraph heading, table, comment, figure, or
movie, because the code or math block is indented and then become
parts of such constructions. Either the block becomes invisible or
error messages are issued.</p>
<p>Sometimes reST reports an &#8220;Unexpected indentation&#8221; at the beginning of
a code block. If you see a <code class="docutils literal"><span class="pre">!bc</span></code>, which should have been removed when
running <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">sphinx</span></code>, it is usually an error in the DocOnce
source, or a problem with the rst/sphinx translator.  Check if the
line before the code block ends in one colon (not two!), a question
mark, an exclamation mark, a comma, a period, or just a newline/space
after text. If not, make sure that the ending is among the
mentioned. Then <code class="docutils literal"><span class="pre">!bc</span></code> will most likely be replaced and a double colon
at the preceding line will appear (which is the right way in reST to
indicate a verbatim block of text).</p>
</div>
<div class="section" id="strange-errors-around-code-or-tex-blocks-in-rest">
<h3>Strange errors around code or TeX blocks in reST<a class="headerlink" href="#strange-errors-around-code-or-tex-blocks-in-rest" title="Permalink to this headline">¶</a></h3>
<p>If <code class="docutils literal"><span class="pre">idx</span></code> commands for defining indices are placed inside paragraphs,
and especially right before a code block, the reST translator
(<code class="docutils literal"><span class="pre">rst</span></code> and <code class="docutils literal"><span class="pre">sphinx</span></code> formats) may get confused and produce strange
code blocks that cause errors when the reST text is transformed to
other formats. The remedy is to define items for the index outside
paragraphs.</p>
</div>
<div class="section" id="something-is-wrong-with-a-verbatim-code-block">
<h3>Something is wrong with a verbatim code block<a class="headerlink" href="#something-is-wrong-with-a-verbatim-code-block" title="Permalink to this headline">¶</a></h3>
<p>Check first that there is a &#8220;normal&#8221; sentence right before
the block (this is important for reST and similar
&#8220;ASCII-close&#8221; formats).</p>
</div>
<div class="section" id="code-tex-block-is-not-shown-in-rest-format">
<h3>Code/TeX block is not shown in reST format<a class="headerlink" href="#code-tex-block-is-not-shown-in-rest-format" title="Permalink to this headline">¶</a></h3>
<p>A comment right before a code or tex block will treat the whole
block also as a comment. It is important that there is normal
running text right before <code class="docutils literal"><span class="pre">!bt</span></code> and <code class="docutils literal"><span class="pre">!bc</span></code> environments.</p>
</div>
<div class="section" id="verbatim-code-blocks-figures-and-admons-inside-lists-look-ugly">
<h3>Verbatim code blocks, figures and admons inside lists look ugly<a class="headerlink" href="#verbatim-code-blocks-figures-and-admons-inside-lists-look-ugly" title="Permalink to this headline">¶</a></h3>
<p>Avoid verbatim code blocks, figures, and admons
inside lists (it makes life easier!).
Instead, use paragraph headings, say</p>
<p><strong>Step 1.</strong>
Describe step. Add figure, code block, admon, etc.</p>
<p><strong>Step 2.</strong>
Describe next step.</p>
<p>If you miss the automatic numbering of items in enumerated lists, you
can simulate that with a Mako variable:</p>
<div class="highlight-doconce"><div class="highlight"><pre>&lt;% counter = 0 %&gt;

&lt;% counter += 1 %&gt;
<span class="gu">__Step ${counter}.__</span>
Describe step. Add figure, code block, admon, etc.

&lt;% counter += 1 %&gt;
<span class="gu">__Step ${counter}.__</span>
Describe next step.
</pre></div>
</div>
</div>
<div class="section" id="latex-code-blocks-inside-lists-look-ugly">
<h3>LaTeX code blocks inside lists look ugly<a class="headerlink" href="#latex-code-blocks-inside-lists-look-ugly" title="Permalink to this headline">¶</a></h3>
<p>Same solution as for computer code blocks as described in the
previous paragraph. Make sure the <code class="docutils literal"><span class="pre">!bt</span></code> and <code class="docutils literal"><span class="pre">!et</span></code> tags are in column 1
and that the rest of the non-LaTeX surrounding text is correctly indented.
Using paragraphs instead of list items is a good idea also here.</p>
</div>
<div class="section" id="latex-code-appears-prior-to-paragraph-headings">
<h3>LaTeX code appears prior to paragraph headings<a class="headerlink" href="#latex-code-appears-prior-to-paragraph-headings" title="Permalink to this headline">¶</a></h3>
<p>If you have a paragraph heading and then code right after,</p>
<div class="highlight-doconce"><div class="highlight"><pre><span class="gu">__Heading.__</span>

<span class="k">!bc</span> pycod
def f(x):
    return 42
<span class="k">!ec</span>
</pre></div>
</div>
<p>the generated LaTeX code is correct, but it is translated to PDF in
a wrong way such that the heading appears <em>after</em> the code.
A remedy is to insert some text after the paragraph heading.
See also the section <a class="reference internal" href="#trouble-bsol-code"><span class="std std-ref">Solution heading in exercise solutions appear after the solution content</span></a> - it is the same problem.</p>
</div>
<div class="section" id="numbered-equations-in-exercise-solutions-change-the-equation-numbers-in-the-text">
<h3>Numbered equations in exercise solutions change the equation numbers in the text...<a class="headerlink" href="#numbered-equations-in-exercise-solutions-change-the-equation-numbers-in-the-text" title="Permalink to this headline">¶</a></h3>
<p>This is a problem if you produce versions with and without solutions,
see the heading &#8220;Numbering of Extra Equations in Solutions&#8221; in the
DocOnce manual for description of the problem and its solutions.</p>
</div>
</div>
<div class="section" id="rest-sphinx">
<h2>reST/Sphinx<a class="headerlink" href="#rest-sphinx" title="Permalink to this headline">¶</a></h2>
<div class="section" id="math-formulas-are-not-rendered-properly">
<h3>Math formulas are not rendered properly<a class="headerlink" href="#math-formulas-are-not-rendered-properly" title="Permalink to this headline">¶</a></h3>
<p>HTML generated by Sphinx applies MathJax for rendering LaTeX mathematics.
Due to the way Sphinx embeds these formulas in HTML, sometimes the
formulas are not being rendered and instead the pure LaTeX code is
put in a box. The same formulas may appear right in pure HTML.</p>
<p>The first thing to do is to check that the LaTeX generated PDF format
shows the formula correctly. The next step is to compile to HTML and
check if MathJax in pure HTML renders the formula correctly. If so,
the formula is correctly typeset, and the problem is related to Sphinx.</p>
<p>There are basically two remedies: either drop Sphinx and go for HTML, or
try to rewrite the formula and try until the Sphinx-generated
HTML code manages to render it.</p>
<p>Copy the problematic typesetting to a minimalistic document. If the
original document is split into pieces via
<code class="docutils literal"><span class="pre">doconce</span> <span class="pre">split_rst</span></code>, make sure your minimalistic document also contains
a <code class="docutils literal"><span class="pre">!split</span></code> command and is split into at least two pieces. This is because
equations get tags when documents are split, and with the <code class="docutils literal"><span class="pre">\tag{}</span></code> command,
it seems that sphinx rewrites the MathJax code, and this may cause
problems. This also means that dropping <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">split_rst</span></code> and having
one big HTML file for Sphinx can make the rendering of mathematics
(much) easier.</p>
<p>Some typical problems encountered are listed below.</p>
<blockquote>
<div><ul class="simple">
<li>Formulas with use of <code class="docutils literal"><span class="pre">\bar\boldsymbol{}</span></code>.</li>
<li>Align environments with multiple equations. Try to simplify
typesetting.</li>
<li><code class="docutils literal"><span class="pre">\mbox</span></code> or <code class="docutils literal"><span class="pre">\hbox</span></code> commands in equations.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="sphinx-directory-generation-aborts-with-label-empty-or-too-long">
<h3>Sphinx directory generation aborts with &#8220;label empty or too long&#8221;<a class="headerlink" href="#sphinx-directory-generation-aborts-with-label-empty-or-too-long" title="Permalink to this headline">¶</a></h3>
<p>This is a strange error that might arise from a too long title of the document.
The solution is to specify a shorter title when running <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">sphinx_dir</span></code> (i.e., to avoid getting the title from the original <code class="docutils literal"><span class="pre">.do.txt</span></code> document):</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce sphinx_dir title=&quot;Short Title&quot; \
          authors=&quot;A. B. Crunch&quot; theme=pyramid mydoc
</pre></div>
</div>
</div>
<div class="section" id="title-level-inconsistent">
<h3>Title level inconsistent<a class="headerlink" href="#title-level-inconsistent" title="Permalink to this headline">¶</a></h3>
<p>reST does not like jumps in the levels of headings. For example, you cannot
have a <code class="docutils literal"><span class="pre">===</span></code> (paragraph) heading after a <code class="docutils literal"><span class="pre">=======</span></code> (section) heading without
a <code class="docutils literal"><span class="pre">====</span></code> (subsection) heading in between.</p>
</div>
<div class="section" id="subsection-headings-appear-at-the-level-of-sections-in-the-table-of-contents">
<h3>Subsection headings appear at the level of sections in the table of contents<a class="headerlink" href="#subsection-headings-appear-at-the-level-of-sections-in-the-table-of-contents" title="Permalink to this headline">¶</a></h3>
<p>This is a problem that arises if you split a Sphinx document at the
subsection level. Then the subsection is the highest level in that part,
and it will then move up to the section level in the table of contents
(this is done by Sphinx, and DocOnce has no influence on the process).</p>
<p>After Oct 2014, DocOnce ignores by default the <code class="docutils literal"><span class="pre">!split</span></code> commands that the
user has inserted and performs a split at the highest section level,
which means that chapters constitute the parts of the
document, if chapters are present, otherwise the sections represent the
different parts. If this behavior is not desired and the user&#8217;s <code class="docutils literal"><span class="pre">!split</span></code>
commands are to be respected, provide the command-line argument
<code class="docutils literal"><span class="pre">--sphinx_keep_splits</span></code> in the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code> command.</p>
</div>
<div class="section" id="lists-do-not-appear-in-rst-files">
<h3>Lists do not appear in .rst files<a class="headerlink" href="#lists-do-not-appear-in-rst-files" title="Permalink to this headline">¶</a></h3>
<p>Check if you have a comment right above the list. That comment
will include the list if the list is indentend. Remove the comment.</p>
</div>
<div class="section" id="error-message-undefined-substitution-from-rest">
<h3>Error message &#8220;Undefined substitution...&#8221; from reST<a class="headerlink" href="#error-message-undefined-substitution-from-rest" title="Permalink to this headline">¶</a></h3>
<p>This may happen if there is much inline math in the text. reST cannot
understand inline LaTeX commands and interprets them as illegal code.
Just ignore these error messages.</p>
</div>
<div class="section" id="warning-about-duplicate-link-names">
<h3>Warning about duplicate link names<a class="headerlink" href="#warning-about-duplicate-link-names" title="Permalink to this headline">¶</a></h3>
<p>Link names should be unique, but if (e.g.) &#8220;file&#8221; is used as link text
several places in a reST file, the links still work. The warning can
therefore be ignorned.</p>
</div>
<div class="section" id="inconsistent-headings-in-rest">
<h3>Inconsistent headings in reST<a class="headerlink" href="#inconsistent-headings-in-rest" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">rst2*.py</span></code> and Sphinx converters abort if the headers of sections
are not consistent, i.e., a subsection must come under a section,
and a subsubsection must come under a subsection (you cannot have
a subsubsection directly under a section). Search for <code class="docutils literal"><span class="pre">===</span></code>,
count the number of equality signs (or underscores if you use that)
and make sure they decrease by two every time a lower level is encountered.</p>
</div>
<div class="section" id="no-code-environment-appears-before-bc-ipy-blocks">
<h3>No code environment appears before &#8220;bc ipy&#8221; blocks<a class="headerlink" href="#no-code-environment-appears-before-bc-ipy-blocks" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">!bc</span> <span class="pre">ipy</span></code> directive behaves this way for <code class="docutils literal"><span class="pre">sphinx</span></code> output because
interactive sessions are automatically handled. If this is not
appropriate, shift to <code class="docutils literal"><span class="pre">!bc</span> <span class="pre">cod</span></code> or another specification of the
verbatim environment.</p>
<p>LaTeX</p>
</div>
<div class="section" id="lines-are-too-long">
<h3>=====  Lines are too long<a class="headerlink" href="#lines-are-too-long" title="Permalink to this headline">¶</a></h3>
<p>Too long lines are often handled with a forced newline like <code class="docutils literal"><span class="pre">\\</span></code> in
LaTeX, but this double backslash does not look good in other formats
when you use DocOnce. Try to rewrite the text such that LaTeX
naturally avoids too long lines. Inline verbatim can easily force
LaTeX to extend the line width, but see if you can use other words to
move the inline verbatim to the left or to the next line.</p>
<p>A last resort is to use the preprocessor and test on <a href="#id1"><span class="problematic" id="id2">``</span></a>FORMAT == &#8216;pdflatex&#8217;`
and then use the double backslash.</p>
</div>
<div class="section" id="tables-get-too-wide-need-to-wrap-text-in-the-columns">
<h3>Tables get too wide - need to wrap text in the columns<a class="headerlink" href="#tables-get-too-wide-need-to-wrap-text-in-the-columns" title="Permalink to this headline">¶</a></h3>
<p>One can use the <code class="docutils literal"><span class="pre">tabularx</span></code> package. This is automatically enabled by
specifying the alignment of the actual column as <code class="docutils literal"><span class="pre">X</span></code> (means <code class="docutils literal"><span class="pre">l</span></code> for
all other output formats), for instance <code class="docutils literal"><span class="pre">|---c----X----|</span></code>.</p>
</div>
<div class="section" id="table-inside-user-defined-environment-does-not-work">
<h3>Table inside user-defined environment does not work<a class="headerlink" href="#table-inside-user-defined-environment-does-not-work" title="Permalink to this headline">¶</a></h3>
<p>If the table appears at the end of the environment (e.g., a theorem or
example environment), add a sentence between the table and
the end-of-environment command.</p>
</div>
<div class="section" id="inline-figures-should-have-more-vertical-space">
<h3>Inline figures should have more vertical space<a class="headerlink" href="#inline-figures-should-have-more-vertical-space" title="Permalink to this headline">¶</a></h3>
<p>Figures without captions become inline figures in LaTeX, and there is
usually no space between above and below the figure so the text and
the figure look very squeezed. Extra space can be
manually inserted with <code class="docutils literal"><span class="pre">&lt;linebreak&gt;</span></code> (which gives a vertical space if
alone on a line):</p>
<div class="highlight-doconce"><div class="highlight"><pre>&lt;linebreak&gt;
&lt;linebreak&gt;

<span class="nb">FIGURE: [...]</span>

&lt;linebreak&gt;
&lt;linebreak&gt;
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-use-a-special-package-for-typesetting-code-k-not-pyg-lst-or-vrb">
<h3>How can I use a special package for typesetting code?K (not <code class="docutils literal"><span class="pre">pyg</span></code>, <code class="docutils literal"><span class="pre">lst</span></code>, or <code class="docutils literal"><span class="pre">vrb</span></code>)<a class="headerlink" href="#how-can-i-use-a-special-package-for-typesetting-code-k-not-pyg-lst-or-vrb" title="Permalink to this headline">¶</a></h3>
<p>One gets the impression that <code class="docutils literal"><span class="pre">--latex_code_style=</span></code> has only the options
for Pygments, Listings, or the Verbatim packages, but in fact any package
can be used.</p>
<p>Suppose you have the fictitious code enviroment <code class="docutils literal"><span class="pre">ultimate</span></code>
from the package <code class="docutils literal"><span class="pre">compcode</span></code> that you want to use, together with
a yellow backgrund, and with some
environment-specific parameters <code class="docutils literal"><span class="pre">arg1</span></code> and <code class="docutils literal"><span class="pre">arg2</span></code>. Then you can write</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format pdflatex mydoc --latex_packages=compcode \
         &#39;--latex_code_style=ultimate-yellow2[arg1=val1,arg2=val2]&#39;
</pre></div>
</div>
<p>The resulting LaTeX code in <code class="docutils literal"><span class="pre">mydoc.tex</span></code> becomes</p>
<div class="highlight-latex"><div class="highlight"><pre><span class="k">\begin</span><span class="nb">{</span>cod<span class="nb">}{</span>cbg<span class="nb">_</span>yellow2<span class="nb">}</span><span class="k">\begin</span><span class="nb">{</span>ultimate<span class="nb">}</span>[arg1=val1,arg2=val2]
...
<span class="k">\end</span><span class="nb">{</span>ultimate<span class="nb">}</span><span class="k">\end</span><span class="nb">{</span>cod<span class="nb">}</span>
</pre></div>
</div>
<p>In this way, you can use any environment in any package for typesetting
code.</p>
</div>
<div class="section" id="sphinx-and-html-show-pygmetized-code-but-not-latex">
<h3>Sphinx and HTML show pygmetized code, but not LaTeX<a class="headerlink" href="#sphinx-and-html-show-pygmetized-code-but-not-latex" title="Permalink to this headline">¶</a></h3>
<p>You have to explicitly select the <code class="docutils literal"><span class="pre">minted</span></code> environment when running <code class="docutils literal"><span class="pre">ptex2tex</span></code>
to get pygmentized computer code in LaTeX:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce ptex2tex mydoc envir=minted
Terminal&gt; pdflatex -shell-escape mydoc
</pre></div>
</div>
</div>
<div class="section" id="latex-error-because-of-underscores">
<h3>LaTeX error because of underscores<a class="headerlink" href="#latex-error-because-of-underscores" title="Permalink to this headline">¶</a></h3>
<p>LaTeX requires prefixing underscores by a backslash. Either typeset
words with underscores in inline verbatim text (so you do not need
the backslash) or use the preprocessor
to insert LaTeX-specific text with a backslash, e.g.,</p>
<div class="highlight-doconce"><div class="highlight"><pre>Here is a word underscore:
%% if FORMAT in (&#39;latex&#39;, &#39;pdflatex&#39;):
my\_word
%% else
my_word
%% endif
</pre></div>
</div>
<p>Usually, inline verbatim text is way to go with underscores anyway.</p>
</div>
<div class="section" id="latex-does-not-like-underscores-in-urls">
<h3>LaTeX does not like underscores in URLs<a class="headerlink" href="#latex-does-not-like-underscores-in-urls" title="Permalink to this headline">¶</a></h3>
<p>Suppose you have a URL reference like</p>
<div class="highlight-text"><div class="highlight"><pre>..which can be found in the file &quot;my_file.txt&quot;:
&quot;http://some.where.net/web/dir/my_file.txt&quot;.
</pre></div>
</div>
<p>LaTeX will stop with a message about a missing dollar sign. The reason
is that underscores in link texts need to be preceded by a backslash.
However, this is incovenient to do in the DocOnce source since the
underscore is misleading in other formats.
The remedy is to format the link text with inline verbatim tags (backticks):</p>
<div class="highlight-text"><div class="highlight"><pre>..which can be found in the file &quot;`my_file.txt`&quot;:
&quot;http://some.where.net/web/dir/my_file.txt&quot;.
</pre></div>
</div>
<p>Verbatim text in links works fine with underscores.</p>
</div>
<div class="section" id="inline-verbatim-fails-in-admon-headings">
<h3>Inline verbatim fails in admon headings<a class="headerlink" href="#inline-verbatim-fails-in-admon-headings" title="Permalink to this headline">¶</a></h3>
<p>A known problem is to have the word</p>
<div class="highlight-text"><div class="highlight"><pre>\Verb
</pre></div>
</div>
<p>in (admon) headings. Otherwise inline verbatim should work, both in
section headings and admon headings.</p>
</div>
<div class="section" id="how-can-i-customize-the-look-of-an-admonition">
<h3>How can I customize the look of an admonition?<a class="headerlink" href="#how-can-i-customize-the-look-of-an-admonition" title="Permalink to this headline">¶</a></h3>
<p id="index-45">The default environment, <code class="docutils literal"><span class="pre">--latex_admon=mdfbox</span></code>, has many options for
customization. Say we want the notice environment to have a very small
font, no background color, no line below the title, no visible frame,
and a smaller width. All this is a matter of editing the
variables in the <code class="docutils literal"><span class="pre">newmdenv</span></code> command that defines the
<code class="docutils literal"><span class="pre">notice_mdfboxmdframed</span></code> environment in the <code class="docutils literal"><span class="pre">.tex</span></code> file.</p>
<p>The simplest approach is to make a script that automatically edits
some of the variables in <code class="docutils literal"><span class="pre">newmdenv</span></code> environments:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">name</span><span class="o">=</span>tmp1
<span class="c"># Edits for mdframed environments</span>
doconce format pdflatex <span class="nv">$name</span> --latex_code_style<span class="o">=</span>vrb
doconce subst <span class="s1">&#39;  backgroundcolor=.+&#39;</span> <span class="se">\</span>
        <span class="s1">&#39;  backgroundcolor=white,&#39;</span> <span class="nv">$name</span>.tex
doconce subst <span class="s1">&#39;  frametitlebackgroundcolor=.+&#39;</span> <span class="se">\</span>
        <span class="s1">&#39;  frametitlebackgroundcolor=white,&#39;</span> <span class="nv">$name</span>.tex
doconce subst <span class="s1">&#39;  leftmargin=.+&#39;</span> <span class="s1">&#39;  leftmargin=3cm,&#39;</span> <span class="nv">$name</span>.tex
doconce subst <span class="s1">&#39;  rightmargin=.+&#39;</span> <span class="se">\</span>
        <span class="s1">&#39;  rightmargin=3cm,\n  font=\\tiny,&#39;</span> <span class="nv">$name</span>.tex
doconce subst <span class="s1">&#39;  frametitlerule=.+&#39;</span> <span class="se">\</span>
        <span class="s1">&#39;  frametitlerule=false,&#39;</span> <span class="nv">$name</span>.tex
doconce subst <span class="s1">&#39;  linewidth=.+&#39;</span> <span class="s1">&#39;  linewidth=0pt,&#39;</span> <span class="nv">$name</span>.tex
<span class="c"># Edits for fontsize in Verbatim</span>
doconce replace <span class="s1">&#39;,fontsize=\fontsize{9pt}{9pt}&#39;</span> <span class="se">\</span>
        <span class="s1">&#39;,fontsize=\fontsize{6pt}{6pt}&#39;</span> <span class="nv">$name</span>.tex
</pre></div>
</div>
<p>Note that these edits actually apply to all types of admonitions!
More tailored edits must include the text of the entire environment definition.</p>
<p>Here is a possible test file:</p>
<div class="highlight-doconce"><div class="highlight"><pre><span class="gh">======= Heading =======</span>

Bla-bla.

<span class="k">!bnotice</span> Long box
% for i in range(10):
bla-bla, bla-bla, bla-bla, bla-bla, bla-bla, bla-bla, bla-bla,
% endfor

<span class="k">!bt</span>
<span class="nb">\begin{align}</span>
x &amp;\in [0,1]\\
y &amp;= sin(x)
<span class="nb">\end{align}</span>
<span class="k">!et</span>

<span class="k">!bc</span> pycod
def myfuncf(x):
    return sin(x)
<span class="k">!ec</span>

% for i in range(100):
bla-bla, bla-bla, bla-bla, bla-bla, bla-bla, bla-bla, bla-bla,
% endfor
<span class="k">!enotice</span>
</pre></div>
</div>
<span class="target" id="index-46"></span><span class="target" id="index-47"></span><p id="index-48">A (much) better approach is to define a <em>user-defined environment</em>,
called (e.g.) minipage, see the <a class="reference external" href="http://hplgit.github.io/doconce/doc/pub/manual/manual.html#manual:userdef:envir">manual</a>.
This environment has begin tag <code class="docutils literal"><span class="pre">!bu-minipage</span></code> and end tag
<code class="docutils literal"><span class="pre">!eu-minipage</span></code>. The environment is defined in a file
<code class="docutils literal"><span class="pre">userdef_environments.py</span></code> in the same directory as the DocOnce source
file.  An example is given in this <a class="reference external" href="https://github.com/hplgit/doconce/blob/master/doc/src/userdef_envirs/minipage/userdef_environments.py">userdef_environments.py</a>
file.</p>
</div>
<div class="section" id="how-can-i-have-unnumbered-sections">
<h3>How can I have unnumbered sections?<a class="headerlink" href="#how-can-i-have-unnumbered-sections" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal"><span class="pre">--section_numbering=off</span></code> option:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format pdflatex mydoc --section_numbering=off
</pre></div>
</div>
</div>
<div class="section" id="latex-suddenly-places-figures-differently">
<h3>LaTeX suddenly places figures differently<a class="headerlink" href="#latex-suddenly-places-figures-differently" title="Permalink to this headline">¶</a></h3>
<p>Until August 25, 2015, the figure environment applied the <code class="docutils literal"><span class="pre">[t]</span></code> (top) option,
but since then the <code class="docutils literal"><span class="pre">[h]</span></code> option is used. Of even greater influence are the
<code class="docutils literal"><span class="pre">topfraction</span></code>, <code class="docutils literal"><span class="pre">bottomfraction</span></code>, and <code class="docutils literal"><span class="pre">textfraction</span></code> parameters in the <code class="docutils literal"><span class="pre">.tex</span></code>
file. See the &#8220;Figures&#8221; section in the manual for more information and how
to customize the placement of figures.</p>
</div>
<div class="section" id="i-want-figure-references-with-page-number-too">
<span id="trouble-figref-mako"></span><h3>I want figure references with page number too<a class="headerlink" href="#i-want-figure-references-with-page-number-too" title="Permalink to this headline">¶</a></h3>
<p>A DocOnce user wanted figure references to be as follows in LaTeX:</p>
<div class="highlight-latex"><div class="highlight"><pre><span class="c">% if current page is different from figure page:</span>
... Figure <span class="k">\ref</span><span class="nb">{</span>my:fig<span class="nb">}</span> on page <span class="k">\pageref</span><span class="nb">{</span>my:fig<span class="nb">}</span>.
<span class="c">% if current page is the same as the figure page:</span>
... Figure <span class="k">\ref</span><span class="nb">{</span>my:fig<span class="nb">}</span>.
</pre></div>
</div>
<p>All other formats should emit the standard treatment of a DocOnce
figure reference with <code class="docutils literal"><span class="pre">ref</span></code>.</p>
<div class="section" id="quick-solution-with-the-varioref-package">
<h4>Quick solution with the <code class="docutils literal"><span class="pre">varioref</span></code> package<a class="headerlink" href="#quick-solution-with-the-varioref-package" title="Permalink to this headline">¶</a></h4>
<p>DocOnce actually generates such references in LaTeX output
if you request the <code class="docutils literal"><span class="pre">varioref</span></code>
package: <code class="docutils literal"><span class="pre">--latex_packages=varioref</span></code> (the standard <code class="docutils literal"><span class="pre">ref</span></code> command
is now replaced by <code class="docutils literal"><span class="pre">\vref</span></code>, except in equation references).</p>
</div>
<div class="section" id="manual-solution-or-a-good-example-on-what-mako-can-do">
<h4>Manual solution (or a good example on what Mako can do)<a class="headerlink" href="#manual-solution-or-a-good-example-on-what-mako-can-do" title="Permalink to this headline">¶</a></h4>
<p>Here is an implementation using if-else tests in LaTeX and
internal variables. Unfortunately, this solution is not reliable
because it uses the <code class="docutils literal"><span class="pre">\thepage</span></code> variable in LaTeX (for the page number
of the current page) and this variable is unreliable. The solution
above (using <code class="docutils literal"><span class="pre">\vref</span></code> and the <code class="docutils literal"><span class="pre">varioref</span></code> package) is much better.
However, the manual solution is a good example on how to use Mako
to do seemingly complicated things.</p>
<p>The above problem can be solved by some Mako programming and
usage of the LaTeX packages <code class="docutils literal"><span class="pre">ifthen</span></code> and <code class="docutils literal"><span class="pre">refcount</span></code>.</p>
<div class="highlight-doconce"><div class="highlight"><pre>&lt;%
def figref(label):
    text = &#39;Figure ref{%s}&#39; % label
    if FORMAT in (&#39;latex&#39;, &#39;pdflatex&#39;):
        text += r&#39;\ifthenelse{\equal{\thepage}{\getpagerefnumber{%s}}}{}{ on page \pageref{%s}}&#39; % (label, label)
    return text
%&gt;

<span class="nb">FIGURE: [myfigfile, width=600 frac=0.8] My figure. label{my:fig}</span>

We refer to ${figref(&#39;my:fig&#39;)}.

...
<span class="c"># Much later</span>
..., as seen in ${figref(&#39;my:fig&#39;)}.
</pre></div>
</div>
<p>The first reference is on the same page as the figure, and LaTeX should
not write the page number, while the second reference is on another
page so both the figure number and the page number should appear in
the output. All other formats have a standard figure reference (translated
to a figure number in HTML and to the caption in Sphinx).</p>
<p>The LaTeX output is something like this:</p>
<div class="highlight-latex"><div class="highlight"><pre><span class="k">\begin</span><span class="nb">{</span>figure<span class="nb">}</span>[h] <span class="c">% my:fig1</span>
  <span class="k">\centerline</span><span class="nb">{</span><span class="k">\includegraphics</span><span class="na">[width=0.8\linewidth]</span><span class="nb">{</span>myfigfile.png<span class="nb">}}</span>
  <span class="k">\caption</span><span class="nb">{</span>
  My figure. <span class="k">\label</span><span class="nb">{</span>my:fig1<span class="nb">}</span>
  <span class="nb">}</span>
<span class="k">\end</span><span class="nb">{</span>figure<span class="nb">}</span>
<span class="c">%\clearpage % flush figures sec:fig</span>

We refer to Figure~<span class="k">\ref</span><span class="nb">{</span>my:fig1<span class="nb">}</span><span class="k">\ifthenelse</span><span class="nb">{</span>
<span class="k">\equal</span><span class="nb">{</span><span class="k">\thepage</span><span class="nb">}{</span><span class="k">\getpagerefnumber</span><span class="nb">{</span>my:fig<span class="nb">}}}{}{</span> on page <span class="k">\pageref</span><span class="nb">{</span>my:fig1<span class="nb">}}</span>.

...
<span class="c">% Much later</span>
..., as seen in Figure~<span class="k">\ref</span><span class="nb">{</span>my:fig1<span class="nb">}</span><span class="k">\ifthenelse</span><span class="nb">{</span>
<span class="k">\equal</span><span class="nb">{</span><span class="k">\thepage</span><span class="nb">}{</span><span class="k">\getpagerefnumber</span><span class="nb">{</span>my:fig<span class="nb">}}}{}{</span> on page <span class="k">\pageref</span><span class="nb">{</span>my:fig1<span class="nb">}}</span>.
</pre></div>
</div>
</div>
</div>
<div class="section" id="error-when-running-latex-you-must-have-pygmentize-installed">
<h3>Error when running latex: You must have &#8216;pygmentize&#8217; installed<a class="headerlink" href="#error-when-running-latex-you-must-have-pygmentize-installed" title="Permalink to this headline">¶</a></h3>
<p>This message points to the use of the minted style for typesetting verbatim
code. You need to include the <code class="docutils literal"><span class="pre">-shell-escape</span></code> command-line argument when
running <code class="docutils literal"><span class="pre">latex</span></code> or <code class="docutils literal"><span class="pre">pdflatex</span></code>:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; latex -shell-escape file mydoc.tex
Terminal&gt; pdflatex -shell-escape file mydoc.tex
</pre></div>
</div>
<p>Using <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">ptex2tex</span></code> will turn on the minted style if specified as
environment on the command line, while using <code class="docutils literal"><span class="pre">ptex2tex</span></code> requires the
preprocessor option <code class="docutils literal"><span class="pre">-DMINTED</span></code> to turn on the minted package.
When this package is included, <code class="docutils literal"><span class="pre">latex</span></code> or <code class="docutils literal"><span class="pre">pdflatex</span></code> runs the
<code class="docutils literal"><span class="pre">pygmentize</span></code> program and the <code class="docutils literal"><span class="pre">shell-escape</span></code> option is required.</p>
</div>
<div class="section" id="why-are-the-latex-section-headings-smaller-than-normal">
<h3>Why are the LaTeX section headings smaller than normal?<a class="headerlink" href="#why-are-the-latex-section-headings-smaller-than-normal" title="Permalink to this headline">¶</a></h3>
<p>DocOnce inserts a special command to make the headings
more compact:</p>
<div class="highlight-text"><div class="highlight"><pre>\usepackage[compact]{titlesec}
</pre></div>
</div>
<p>as explained in the <a class="reference external" href="http://www.ctex.org/documents/packages/layout/titlesec.pdf">titlesec</a> package documentation.
To retrieve the standard LaTeX headings, comment out this line or remove it:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format pdflatex mydoc
Terminal&gt; doconce subst &#39;\\usepack.+\{titlesec\} &#39;&#39; mydoc.p.tex
</pre></div>
</div>
<p>You can easily make the headings even smaller than the normal font
by replacing <code class="docutils literal"><span class="pre">[compact]</span></code> by <code class="docutils literal"><span class="pre">[compact,small]</span></code> as parameter specification
for <code class="docutils literal"><span class="pre">titlesec</span></code>.</p>
</div>
<div class="section" id="i-get-latex-compilation-errors-about-shadedquoteblue-in-code-blocks-in-exercises">
<h3>I get LaTeX compilation errors about &#8220;shadedquoteBlue&#8221; in code blocks in exercises<a class="headerlink" href="#i-get-latex-compilation-errors-about-shadedquoteblue-in-code-blocks-in-exercises" title="Permalink to this headline">¶</a></h3>
<p>When using colored boxes for code in LaTeX, a code snippet is needed
in the ordinary running text <em>before</em> code snippets inside exercises, problems,
or projects. This is a kind of bug in DocOnce that is challenging to fix.
It is usually only a problem when writing documents mainly containing
exercises, problems, or projects.</p>
</div>
<div class="section" id="i-get-compilation-error-due-to-pause-commands">
<h3>I get compilation error due to pause commands<a class="headerlink" href="#i-get-compilation-error-due-to-pause-commands" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">|\pause|</span></code> commands are intended for popping up code segments
in slides. If you compile the document without having run <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">slides_beamer</span></code> first, standard LaTeX have a problem with <code class="docutils literal"><span class="pre">|\pause|</span></code>. The remedy is
to just remove these commands by</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce subst &#39;\|\\pause\|\n&#39; &#39;&#39; mydoc.tex
</pre></div>
</div>
<p>before running <code class="docutils literal"><span class="pre">pdflatex</span> <span class="pre">mydoc</span></code>.</p>
</div>
<div class="section" id="the-cell-structure-in-slides-does-not-work-for-me">
<h3>The cell structure in slides does not work for me ...<a class="headerlink" href="#the-cell-structure-in-slides-does-not-work-for-me" title="Permalink to this headline">¶</a></h3>
<p>Common errors:</p>
<blockquote>
<div><ul class="simple">
<li>Empty cells? No cell can be empty. Just insert a comment <code class="docutils literal"><span class="pre">#</span> <span class="pre">Empty</span> <span class="pre">cell</span></code>
to make it non-empty.</li>
<li>Wrong numbering of the cells. They go 00, 01, 02, 10, 11, etc.</li>
</ul>
</div></blockquote>
<p>Also, text outside the slidecell boxes <em>are not shown</em> in the slide.
Everything you want to see must be inside the cells. Use <code class="docutils literal"><span class="pre">&lt;linebreak&gt;</span></code>
repeatedly to insert vertical spacings inside cells.</p>
</div>
<div class="section" id="can-i-have-latex-figures-with-shadows">
<h3>Can I have LaTeX figures with shadows?<a class="headerlink" href="#can-i-have-latex-figures-with-shadows" title="Permalink to this headline">¶</a></h3>
<p>This is easy by including the <code class="docutils literal"><span class="pre">fancybox</span></code> and <code class="docutils literal"><span class="pre">graphicx</span></code> packages
and wrapping all <code class="docutils literal"><span class="pre">\includegraphics</span></code> in a shadow box:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format pdflatex mydoc
Terminal&gt; doconce replace \
          &#39;microtype}&#39;, &#39;microtype,fancybox,graphicx}&#39; mydoc.p.tex
Terminal&gt; doconce subst &#39;(\\includegraphics\[.+\}\})&#39; \
          &#39;\\shadowbox{\g&lt;1&gt;}&#39; mydoc.p.tex
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-use-my-fancy-latex-environments">
<h3>How can I use my fancy LaTeX environments?<a class="headerlink" href="#how-can-i-use-my-fancy-latex-environments" title="Permalink to this headline">¶</a></h3>
<p>See the section <em>Example: Defining a Theorem Environment</em> in
the DocOnce manual for how to make a custom
theorem environment also in DocOnce, without using implementations
restricted to LaTeX. See also the section <a class="reference internal" href="#trouble-latex-envir-native"><span class="std std-ref">How can I make use of a native LaTeX environments (example environment for instance)?</span></a>.</p>
</div>
<div class="section" id="the-latex-file-does-not-compile">
<h3>The LaTeX file does not compile<a class="headerlink" href="#the-latex-file-does-not-compile" title="Permalink to this headline">¶</a></h3>
<p>If the problem is undefined control sequence involving</p>
<div class="highlight-text"><div class="highlight"><pre>\code{...}
</pre></div>
</div>
<p>the cause is usually a verbatim inline text (in back-ticks in the
DocOnce file) spans more than one line. Make sure, in the DocOnce source,
that all inline verbatim text appears on the same line.</p>
</div>
<div class="section" id="the-latex-beamer-file-does-not-compile">
<h3>The LaTeX Beamer file does not compile<a class="headerlink" href="#the-latex-beamer-file-does-not-compile" title="Permalink to this headline">¶</a></h3>
<p>Make sure you have a <code class="docutils literal"><span class="pre">!split</span></code> before every slide heading.</p>
</div>
<div class="section" id="inline-verbatim-gives-error">
<h3>Inline verbatim gives error<a class="headerlink" href="#inline-verbatim-gives-error" title="Permalink to this headline">¶</a></h3>
<p>Check if the inline verbatim contains typical LaTeX commands, e.g.,</p>
<div class="highlight-text"><div class="highlight"><pre>some text with `\usepackage{mypack}` is difficult because
ptex2tex will replace this by \code{\usepackage{mypack}} and
then replace this by
{\fontsize{10pt}{10pt}\verb!\usepackage{mypack!}}
which is wrong because ptex2tex applies regex that don&#39;t
capture the second }
</pre></div>
</div>
<p>The remedy is to place verbatim LaTeX commands in verbatim
blocks - that is safe.</p>
</div>
<div class="section" id="errors-in-figure-captions">
<h3>Errors in figure captions<a class="headerlink" href="#errors-in-figure-captions" title="Permalink to this headline">¶</a></h3>
<p>Such errors typically arise from unbalanced curly braces, or dollar signs
around math, and similar LaTeX syntax errors.</p>
<p>(Note that verbatim font is likely to cause trouble inside figure captions,
but DocOnce will automatically replace verbatim text in back-ticks by
a proper <code class="docutils literal"><span class="pre">texttt</span></code> command (since verbatim font constructions does not work
inside figure captions) and precede underscores by backslash.)</p>
</div>
<div class="section" id="i-want-to-tune-the-top-preamble-of-the-latex-file">
<span id="latex-custom-preamble"></span><h3>I want to tune the top (preamble) of the LaTeX file<a class="headerlink" href="#i-want-to-tune-the-top-preamble-of-the-latex-file" title="Permalink to this headline">¶</a></h3>
<p>It is easy to provide
a customized preamble text:</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format latex mydoc --latex_preamble=mytop.tex
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">mytop.tex</span></code> starts with a <code class="docutils literal"><span class="pre">documentclass</span></code> specification, the whole
file becomes the complete preamble in <code class="docutils literal"><span class="pre">mydoc.p.tex</span></code>, otherwise
<code class="docutils literal"><span class="pre">mytop.tex</span></code> is added at the end of the preamble generated by
DocOnce.</p>
<p>If you already have some preamble that defines styles etc., I recommend
to generate a <code class="docutils literal"><span class="pre">.tex</span></code> file from DocOnce and merge the preamble you have
with the one generated by DocOnce. When the <code class="docutils literal"><span class="pre">.tex</span></code> file compiles with
the desired preamble, store it in a separate file and
use it with the <code class="docutils literal"><span class="pre">--latex_preamble=</span></code> option. (This approach will for
fix the preamble for the future so updates of the DocOnce-generated
preamble will not be available for this document.)</p>
<p>Note also that <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code> and <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span></code> can be used
after <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code> to tune the LaTeX code in the preamble (and
elsewhere). Such automatic edits are useful if they are few.</p>
<p>There are comment lines with <code class="docutils literal"><span class="pre">---</span> <span class="pre">begin</span> <span class="pre">preamble</span> <span class="pre">---</span></code> and
<code class="docutils literal"><span class="pre">---</span> <span class="pre">end</span> <span class="pre">preamble</span> <span class="pre">---</span></code> in the generated <code class="docutils literal"><span class="pre">.tex</span></code> file that can be
used to replace the whole preamble by another text via a script.</p>
</div>
<div class="section" id="how-can-i-control-the-placement-of-figures">
<h3>How can I control the placement of figures?<a class="headerlink" href="#how-can-i-control-the-placement-of-figures" title="Permalink to this headline">¶</a></h3>
<p>In general, LaTeX will control the placement, and DocOnce applies
(for now) the <code class="docutils literal"><span class="pre">[t]</span></code> option to recommend figures to be placed at the top
of a page. This can be changed in different ways, using
techniques from the sections <a class="reference internal" href="#latex-custom-fig-name"><span class="std std-ref">How do I get &#8220;Figure&#8221; written in another language?</span></a> and
<a class="reference internal" href="#latex-custom-preamble"><span class="std std-ref">I want to tune the top (preamble) of the LaTeX file</span></a>. The <code class="docutils literal"><span class="pre">float</span></code> package and the <code class="docutils literal"><span class="pre">[H]</span></code> (&#8220;here&#8221;)
option for figures makes figures appear closer to their original
location:</p>
<div class="highlight-latex"><div class="highlight"><pre><span class="k">\usepackage</span><span class="nb">{</span>float<span class="nb">}</span>
<span class="k">\floatplacement</span><span class="nb">{</span>figure<span class="nb">}{</span>H<span class="nb">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">[t]</span></code> option in figures must be removed:</p>
<div class="highlight-text"><div class="highlight"><pre>doconce replace &#39;{figure}[t]&#39; &#39;{figure}&#39; mydoc.tex
</pre></div>
</div>
<p><strong>Custom preamble file.</strong>
Place the lines above in a file <code class="docutils literal"><span class="pre">mypreamble.tex</span></code> and ask DocOnce to add
this file to the preamble: <code class="docutils literal"><span class="pre">--latex_preamble=mypreamble.tex</span></code>.</p>
<p><strong>Edit the .tex file.</strong>
There is a special line in the <code class="docutils literal"><span class="pre">.tex</span></code> file,</p>
<div class="highlight-text"><div class="highlight"><pre>%% insert custom LaTeX commands...
</pre></div>
</div>
<p>which can be used
to insert desired commands, in this case by</p>
<div class="highlight-text"><div class="highlight"><pre>doconce subst &#39;% insert custom LaTeX.+&#39; &#39;\\usepackage{float}\n\floatplacement{figure}{H}&#39; mydoc.tex
</pre></div>
</div>
<p>Note that you in both cases
need to run the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code> above command to remove the <code class="docutils literal"><span class="pre">[t]</span></code>
option.</p>
</div>
<div class="section" id="how-can-i-get-a-two-column-text">
<h3>How can I get a two-column text?<a class="headerlink" href="#how-can-i-get-a-two-column-text" title="Permalink to this headline">¶</a></h3>
<p>Simply add <code class="docutils literal"><span class="pre">twocolum</span></code> to the <code class="docutils literal"><span class="pre">\documentclass</span></code> command. If the <code class="docutils literal"><span class="pre">mydoc.tex</span></code>
file looks like</p>
<div class="highlight-latex"><div class="highlight"><pre><span class="k">\documentclass</span>[<span class="c">%</span>
twoside,
...
</pre></div>
</div>
<p>you can do a simple substitution edit</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce subst &#39;twoside,&#39; &#39;twocolumn,\ntwoside,&#39; mydoc.tex
</pre></div>
</div>
</div>
<div class="section" id="solution-heading-in-exercise-solutions-appear-after-the-solution-content">
<span id="trouble-bsol-code"></span><h3>Solution heading in exercise solutions appear after the solution content<a class="headerlink" href="#solution-heading-in-exercise-solutions-appear-after-the-solution-content" title="Permalink to this headline">¶</a></h3>
<p>Sometimes a solution environment with code</p>
<div class="highlight-doconce"><div class="highlight"><pre><span class="k">!bsol</span>
<span class="k">!bc</span> cod
def f(x):
    return x + 2
<span class="k">!ec</span>
<span class="k">!esol</span>
</pre></div>
</div>
<p>leads to strange behavior with verbatim LaTeX
environment: the <strong>Solution</strong> heading appears after the code
in the solution. This appears to be a LaTeX problem since the
generated LaTeX code has the heading and solution content in the right
order. A working remedy is to insert a text before the code:</p>
<div class="highlight-doconce"><div class="highlight"><pre>Code:
<span class="k">!bsol</span>
<span class="k">!bc</span> cod
def f(x):
    return x + 2
<span class="k">!ec</span>
<span class="k">!esol</span>
</pre></div>
</div>
</div>
<div class="section" id="subexercises-subex-a-triggers-missing-number-treated-as-zero">
<h3>Subexercises (<code class="docutils literal"><span class="pre">subex{a)}</span></code>) triggers &#8220;Missing number, treated as zero&#8221;<a class="headerlink" href="#subexercises-subex-a-triggers-missing-number-treated-as-zero" title="Permalink to this headline">¶</a></h3>
<p>Check if you have
done a <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span></code> of <code class="docutils literal"><span class="pre">section</span></code> to <code class="docutils literal"><span class="pre">section*</span></code>. Such a substitution
will alter the newcommand <code class="docutils literal"><span class="pre">\subex</span></code> defined in the <code class="docutils literal"><span class="pre">.tex</span></code> file and insert
an erroneous <code class="docutils literal"><span class="pre">\&#64;startsection*</span></code>, which should not contain the <code class="docutils literal"><span class="pre">*</span></code>.
Be more specific with the substitution of <code class="docutils literal"><span class="pre">section</span></code> in the <code class="docutils literal"><span class="pre">.tex</span></code> file:</p>
<div class="highlight-bash"><div class="highlight"><pre>doconce subst <span class="s1">&#39;\\section\{&#39;</span> <span class="s1">&#39;\\section*{&#39;</span> mydoc.tex
doconce subst <span class="s1">&#39;\\subsection\{&#39;</span> <span class="s1">&#39;\\subsection*{&#39;</span> mydoc.tex
<span class="c"># or</span>
doconce replace <span class="s1">&#39;\section{&#39;</span> <span class="s1">&#39;\section*{&#39;</span> mydoc.tex
doconce replace <span class="s1">&#39;\subsection{&#39;</span> <span class="s1">&#39;\subsection*{&#39;</span> mydoc.tex
</pre></div>
</div>
</div>
<div class="section" id="page-numbers-appear-in-both-header-and-footer">
<h3>Page numbers appear in both header and footer<a class="headerlink" href="#page-numbers-appear-in-both-header-and-footer" title="Permalink to this headline">¶</a></h3>
<p>If you experience page numbers in header and footer (this is a problem
if you have <code class="docutils literal"><span class="pre">{copyright...}</span></code> notifications as part of an <code class="docutils literal"><span class="pre">AUTHOR</span></code>
specification), you need to edit
the <code class="docutils literal"><span class="pre">.tex</span></code> file. Removing the page number in the footer is done by</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce subst &#39;\\fancyfoot\[LE.+&#39; &#39;&#39; mydoc.tex
</pre></div>
</div>
<p>Page numbers in headers typically arise from using a special LaTeX style
or the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span></code> option <code class="docutils literal"><span class="pre">--latex_fancy_header</span></code> (but in the latter
case there will never be page numbers in the footer).</p>
</div>
<div class="section" id="links-in-the-table-of-contents-go-to-wrong-page">
<h3>Links in the table of contents go to wrong page<a class="headerlink" href="#links-in-the-table-of-contents-go-to-wrong-page" title="Permalink to this headline">¶</a></h3>
<p>This is not an uncommon problem. We <a class="reference external" href="http://tex.stackexchange.com/questions/23499/incorrect-bookmarks-and-page-number-in-table-of-contents">resolved this problem</a>
for the index by adding <code class="docutils literal"><span class="pre">\cleardoublepage\phantomsection</span></code> right before
<code class="docutils literal"><span class="pre">\printindex</span></code>.  The same trick can be useful in other contexts.</p>
</div>
<div class="section" id="exercises-in-the-springer-sv-style-looks-strange">
<h3>Exercises in the <code class="docutils literal"><span class="pre">Springer_sv</span></code> style looks strange<a class="headerlink" href="#exercises-in-the-springer-sv-style-looks-strange" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">Springer_sv</span></code> style demands exercises to appear within the <code class="docutils literal"><span class="pre">prob</span></code>
environment, and the <code class="docutils literal"><span class="pre">svmono.cls</span></code> package typesets <code class="docutils literal"><span class="pre">prob</span></code> with small
headlines.</p>
</div>
<div class="section" id="how-to-typeset-papers-with-specified-style-files">
<span id="trouble-latex-styles"></span><h3>How to typeset papers with specified style files?<a class="headerlink" href="#how-to-typeset-papers-with-specified-style-files" title="Permalink to this headline">¶</a></h3>
<span class="target" id="index-49"></span><p id="index-50">DocOnce has the <code class="docutils literal"><span class="pre">--latex_style=</span></code> option for specifying a few LaTeX
styles for papers and books. This option mostly support book styles,
since traditionally, paper styles in various journals often have
special commands for authors, institutions, summary, and so on that are
cumbersome to support through DocOnce. It was often easier to develop the
paper in DocOnce and at submission time, manually edit the LaTeX output
to fit a particular journal style. (SIAM and Elsevier journal have had
direct support in DocOnce, though.)</p>
<p>With open access publishing it makes more sense to maintain a paper
in DocOnce and publish derived and future versions in various electronic
formats. How to then, at some stage in the process, make a special
LaTeX version according to a journal&#8217;s style?</p>
<p>The simplest approach is probably to develop a compilation script that
performs a set of edits through <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code> and <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span></code>
commands that turn standard DocOnce LaTeX output into the text required
for a special journal style. Usually, such edits are about adding
packages, maybe some special commands, and replacing perhaps title,
author, date, and summary commands. Below is a sketch how that can be
done for <a class="reference external" href="https://www.plos.org/">PLOS journals</a>. These journals
offer a <a class="reference external" href="http://journals.plos.org/plosone/s/latex">LaTeX template</a>
demonstrating appropriate commands. Some text is needed in the preamble,
and we can insert that text at the place marked for user-specific
extensions (&#8220;insert custom LaTeX commands...&#8221;).</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="nv">name</span><span class="o">=</span>mydoc

<span class="c"># Compile mydoc.do.txt to latex output mydoc.tex</span>
doconce format pdflatex <span class="nv">$name</span> --latex_bibstyle<span class="o">=</span>plos2015 --latex_code_style<span class="o">=</span>vrb

<span class="c"># Edit mydoc.tex file</span>
doconce subst <span class="s1">&#39;% insert custom LaTeX commands...&#39;</span> <span class="s1">&#39;</span>
<span class="s1">\usepackage[aboveskip=1pt,labelfont=bf,labelsep=period,justification=raggedright,singlelinecheck=off]{caption}</span>
<span class="s1">% Text layout</span>
<span class="s1">\raggedright</span>
<span class="s1">\setlength{\parindent}{0.5cm}</span>
<span class="s1">\textwidth 5.25in</span>
<span class="s1">\textheight 8.75in</span>
<span class="s1">% Remove brackets from numbering in List of References</span>
<span class="s1">\makeatletter</span>
<span class="s1">\renewcommand{\@biblabel}[1]{\quad#1.}</span>
<span class="s1">\makeatother</span>
<span class="s1">\usepackage[right]{lineno}</span>
<span class="s1">\usepackage[top=0.85in,left=2.75in,footskip=0.75in]{geometry}&#39;</span> <span class="nv">$name</span>.tex

<span class="c"># Compile the usual way</span>
pdflatex <span class="nv">$name</span>
</pre></div>
</div>
<p>This example hopefully gives some ideas how to create specialized
LaTeX output from DocOnce documents. If the journal style employs
special LaTeX environments, see the section <a class="reference internal" href="#trouble-latex-envir-native"><span class="std std-ref">How can I make use of a native LaTeX environments (example environment for instance)?</span></a>
how to utilize these from DocOnce.</p>
<p>gwiki</p>
</div>
<div class="section" id="strange-nested-lists-in-gwiki">
<h3>=====  Strange nested lists in gwiki<a class="headerlink" href="#strange-nested-lists-in-gwiki" title="Permalink to this headline">¶</a></h3>
<p>DocOnce cannot handle nested lists correctly in the gwiki format.
Use nonnested lists or edit the <code class="docutils literal"><span class="pre">.gwiki</span></code> file directly.</p>
</div>
<div class="section" id="lists-in-gwiki-look-ugly-in-the-gwiki-source">
<h3>Lists in gwiki look ugly in the gwiki source<a class="headerlink" href="#lists-in-gwiki-look-ugly-in-the-gwiki-source" title="Permalink to this headline">¶</a></h3>
<p>Because the Google Code wiki format requires all text of a list item to
be on one line, DocOnce simply concatenates lines in that format,
and because of the indentation in the original DocOnce text, the gwiki
output looks somewhat ugly. The good thing is that this gwiki source
is seldom to be looked at - it is the DocOnce source that one edits
further.</p>
</div>
</div>
<div class="section" id="html">
<h2>HTML<a class="headerlink" href="#html" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-can-i-add-a-search-facility-to-an-html-document">
<h3>How can I add a search facility to an HTML document?<a class="headerlink" href="#how-can-i-add-a-search-facility-to-an-html-document" title="Permalink to this headline">¶</a></h3>
<p>There are many services for this. <a class="reference external" href="http://www.freefind.com/">FreeFind</a>
is an easy-to-use service that gives you some HTML code to include
in the document, typically inside a <code class="docutils literal"><span class="pre">#</span> <span class="pre">#if</span> <span class="pre">FORMAT</span> <span class="pre">==</span> <span class="pre">&quot;html&quot;</span></code> and <code class="docutils literal"><span class="pre">#</span> <span class="pre">#endif</span></code>
block.</p>
</div>
<div class="section" id="mathjax-formulas-are-not-properly-rendered">
<h3>MathJax formulas are not properly rendered<a class="headerlink" href="#mathjax-formulas-are-not-properly-rendered" title="Permalink to this headline">¶</a></h3>
<p>Here are some common problems:</p>
<blockquote>
<div><ul class="simple">
<li>Two equations cannot have identical label (this error often arises
from copying and pasting equations).</li>
<li><code class="docutils literal"><span class="pre">[</span></code> and <code class="docutils literal"><span class="pre">]</span></code> brackets must sometimes be replaced by <code class="docutils literal"><span class="pre">\lbrack</span></code> and <code class="docutils literal"><span class="pre">\rbrack</span></code>.</li>
<li>Inline mathematics cannot have a space after the first dollar sign.</li>
<li>Equation environments must be <code class="docutils literal"><span class="pre">\[</span> <span class="pre">...\]</span></code>, <code class="docutils literal"><span class="pre">equation</span></code>, <code class="docutils literal"><span class="pre">equation*</span></code>,
<code class="docutils literal"><span class="pre">align</span></code>, or <code class="docutils literal"><span class="pre">align*</span></code> - avoid all other types of environments
(<code class="docutils literal"><span class="pre">split</span></code>, <code class="docutils literal"><span class="pre">alignat</span></code>, and whatever).</li>
<li>Errors in formulas that LaTeX accepts may still
lead to unrendered formulas in MathJax.</li>
</ul>
</div></blockquote>
<p>If the corresponding LaTeX-based PDF output has the correct formula,
one must try to rewrite the LaTeX mathematics so MathJax accepts
it. MathJax can only handle a subset of what is legal mathematics in
LaTeX.</p>
<p>Even if HTML is your target output format, it is strongly recommended to
develop the mathematics with <code class="docutils literal"><span class="pre">pdflatex</span></code> as output to debug formulas
before you try to render them in MathJax.</p>
</div>
<div class="section" id="how-can-i-change-the-layout-of-the-html-page">
<h3>How can I change the layout of the HTML page?<a class="headerlink" href="#how-can-i-change-the-layout-of-the-html-page" title="Permalink to this headline">¶</a></h3>
<div class="section" id="autoedits-of-the-html-file">
<h4>Autoedits of the <code class="docutils literal"><span class="pre">.html</span></code> file<a class="headerlink" href="#autoedits-of-the-html-file" title="Permalink to this headline">¶</a></h4>
<p>The easiest way is to edit the HTML style or the HTML code directly.
However, those edits are overwritten the next time you compile the
DocOnce document to HTML. The edits should therefore be automated
using the <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">subst</span></code> (for regular expression editing) or <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">replace</span></code>
(for plain text substitution editing) commands in the file where
you run <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">html</span> <span class="pre">mydoc</span></code>. For example, say you want narrower
gray admonition boxes with a much thicker boundary. The <code class="docutils literal"><span class="pre">.alert</span></code>
style must then be changed, more precisely the <code class="docutils literal"><span class="pre">border</span></code> and the <code class="docutils literal"><span class="pre">width</span></code>
specification. You can then add these statements after running <code class="docutils literal"><span class="pre">doconce</span> <span class="pre">format</span> <span class="pre">html</span> <span class="pre">...</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre>doconce replace <span class="s1">&#39;border:1px&#39;</span> <span class="s1">&#39;border:11px&#39;</span> mydoc.html
doconce replace <span class="s1">&#39;width: 75%;&#39;</span> <span class="s1">&#39;width: 35%&#39;</span> mydoc.html
</pre></div>
</div>
</div>
<div class="section" id="specify-a-css-file">
<h4>Specify a <code class="docutils literal"><span class="pre">.css</span></code> file<a class="headerlink" href="#specify-a-css-file" title="Permalink to this headline">¶</a></h4>
<p>Another way to control the layout is to copy the style in the HTML
file into a <code class="docutils literal"><span class="pre">.css</span></code> file, edit that file as you like, and provide the
file as part of the compilation using the <code class="docutils literal"><span class="pre">--css=mystyle.css</span></code>
flag. For example, say you want to transform the headings to something
attractive for young girls (white text on pink background). A <code class="docutils literal"><span class="pre">.css</span></code>
file can be written from scratch, but one can also generate one from
one of the built-in DocOnce HTML styles by running</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format html mydoc --css=pink.css \
          --html_style=blueish
</pre></div>
</div>
<p>The result is a new file <code class="docutils literal"><span class="pre">pink.css</span></code> containing the specification
of the <code class="docutils literal"><span class="pre">blueish</span></code> style. One can now change this <code class="docutils literal"><span class="pre">pink.css</span></code> file
to <code class="docutils literal"><span class="pre">h1</span></code> headings with pink background and white text, <code class="docutils literal"><span class="pre">h2</span></code> and <code class="docutils literal"><span class="pre">h3</span></code>
headings with pink text, and pink color for visited or hovered hyperlinks:</p>
<div class="highlight-html"><div class="highlight"><pre>h1 {
    font-family:&quot;comic sans ms&quot;;
    width: 900px;
    font-size: 48px;
    text-align: center;
    background: #EA00FF; /* pink */
    border-style: solid;
    border-width: 5px;
    border-color: #FFFFFF;
    padding: 20px;
    margin: 20px;
    margin-left: 10px;
    color: white
}
h2, h3 {
    font-family:&quot;comic sans ms&quot;;
    font-size: 18px;
    color: #EA00FF;
}
h3 { font-size: 24px; }
a { color: #1e36ce; text-decoration:none; }
a:hover, a:visited { color: #EA00FF; /* pink */ }
...
</pre></div>
</div>
<p>The rest of the file can remain unaltered. Running</p>
<div class="highlight-text"><div class="highlight"><pre>Terminal&gt; doconce format html mydoc --css=pink.css \
          --html_style=blueish
</pre></div>
</div>
<p>will now render <code class="docutils literal"><span class="pre">mydoc.html</span></code> with pink headings and visited links.</p>
</div>
<div class="section" id="specify-a-template">
<h4>Specify a template<a class="headerlink" href="#specify-a-template" title="Permalink to this headline">¶</a></h4>
<p>The standard of way of completely controlling the HTML format is to
use an HTML template. The DocOnce source is then the body of text
(leave out <code class="docutils literal"><span class="pre">TITLE:</span></code> to get HTML without a header and footer). The
<code class="docutils literal"><span class="pre">--html_template=filename</span></code> command-line option will then embed the
DocOnce text in the specified template file, where you can use style
sheets and desired constructs in the header and footer.  The template
can have &#8220;slots&#8221; for a title (<code class="docutils literal"><span class="pre">%(title)s</span></code>), a date (<code class="docutils literal"><span class="pre">%(date)s</span></code>), and
the main body of text (<code class="docutils literal"><span class="pre">%(main)s</span></code>).  For typesetting code, <code class="docutils literal"><span class="pre">pygments</span></code>
is used (if installed) and can be turned off by <code class="docutils literal"><span class="pre">--no_pygments_html</span></code>
(leaving code in gray boxes).</p>
<p>The easiest way is to get fancy layouts in HTML is to
use the <code class="docutils literal"><span class="pre">sphinx</span></code> format and one its many themes.</p>
</div>
</div>
<div class="section" id="why-do-figures-look-ugly-when-using-html-templates">
<h3>Why do figures look ugly when using HTML templates?<a class="headerlink" href="#why-do-figures-look-ugly-when-using-html-templates" title="Permalink to this headline">¶</a></h3>
<p>The HTML header that DocOnce generates contain special styles for
figure captions and the horizontal rule above figures. When using
templates these styles are not defined, resulting in a rule that
spans the width and a centered caption. Changing the appearance
of the rule and caption can either be done by inserting styles or
simply by automatic editing of the HTML code in a little shell script:</p>
<div class="highlight-text"><div class="highlight"><pre>doconce replace &#39;&lt;p class=&quot;caption&quot;&gt;&#39; \
 &#39;&lt;p style=&quot;width: 50%; font-style: italic; color: blue&quot;&gt;&#39; mydoc.html
doconce replace &#39;&lt;hr class=&quot;figure&quot;&gt;&#39; \
 &#39;&lt;hr style=&quot;width:60%, font-style: normal&quot;&gt;&#39; mydoc.html
</pre></div>
</div>
</div>
</div>
<div class="section" id="reveal-deck-html5-slides">
<h2>reveal/deck HTML5 slides<a class="headerlink" href="#reveal-deck-html5-slides" title="Permalink to this headline">¶</a></h2>
<div class="section" id="python-online-tutor-code-does-not-work-in-reveal">
<h3>Python Online Tutor code does not work in reveal<a class="headerlink" href="#python-online-tutor-code-does-not-work-in-reveal" title="Permalink to this headline">¶</a></h3>
<p>Use the Chrome browser (the code does not work in Firefox in combination
with reveal HTML5, but it works in plain HTML).</p>
</div>
<div class="section" id="reveal-slides-are-stacked-on-top-of-each-other">
<h3>Reveal slides are stacked on top of each other<a class="headerlink" href="#reveal-slides-are-stacked-on-top-of-each-other" title="Permalink to this headline">¶</a></h3>
<p>This problem can be caused by having a <code class="docutils literal"><span class="pre">!bblock</span></code> environment crossing two
slides because of a forgotten <code class="docutils literal"><span class="pre">!eblock</span></code> on the first slide.
To locate the problematic slides, copy chunks of slides to a new file,
compile, and inspect. This will reveal the problematic chunk.</p>
</div>
<div class="section" id="reveal-slides-are-moving-steadily-to-the-left">
<h3>Reveal slides are moving steadily to the left<a class="headerlink" href="#reveal-slides-are-moving-steadily-to-the-left" title="Permalink to this headline">¶</a></h3>
<p>This seems to be a problem when one has used the mouse to scroll down
on a slide and continue to use the right arrow for moving to the
next slide. Click on the arrow in the slide instead of using the arrow key.</p>
</div>
<div class="section" id="youtube-movies-do-not-work">
<h3>YouTube movies do not work<a class="headerlink" href="#youtube-movies-do-not-work" title="Permalink to this headline">¶</a></h3>
<p>They do not work in reveal or deck unless the Chrome browser is used.
Usually the HTML5 slides work best in Firefox.</p>
</div>
<div class="section" id="online-python-tutor-does-not-work">
<h3>Online Python Tutor does not work<a class="headerlink" href="#online-python-tutor-does-not-work" title="Permalink to this headline">¶</a></h3>
<p>Seems to be a problem with reveal slides. The <em>Forward</em> button is not
clickable.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">DocOnce Troubleshooting and FAQ</a><ul>
<li><a class="reference internal" href="#general-topics">General topics</a><ul>
<li><a class="reference internal" href="#how-do-i-debug-a-doconce-file-that-results-in-a-strange-error-message">How do I debug a DocOnce file that results in a strange error message?</a></li>
<li><a class="reference internal" href="#how-do-i-cite-and-link-to-doconce">How do I cite and link to DocOnce?</a></li>
<li><a class="reference internal" href="#translation-aborts-when-labels-are-not-defined">Translation aborts when labels are not defined</a></li>
<li><a class="reference internal" href="#how-to-i-control-the-table-of-contents">How to I control the table of contents?</a></li>
<li><a class="reference internal" href="#how-can-i-add-links-to-some-resource-on-every-page">How can I add links to some resource on every page?</a><ul>
<li><a class="reference internal" href="#bootstrap-html-styles">Bootstrap HTML styles</a></li>
<li><a class="reference internal" href="#vagrant-html-template">Vagrant HTML template</a></li>
<li><a class="reference internal" href="#sphinx-bootstrap-theme">Sphinx bootstrap theme</a></li>
</ul>
</li>
<li><a class="reference internal" href="#why-are-underscores-in-text-a-potential-problem">Why are underscores in text a potential problem?</a></li>
<li><a class="reference internal" href="#github-gh-pages-will-not-display-files-starting-with-a-dot-or-underscore">GitHub gh-pages will not display files starting with a dot or underscore</a></li>
<li><a class="reference internal" href="#github-gh-pages-will-not-display-files">GitHub gh-pages will not display files</a></li>
<li><a class="reference internal" href="#blank-line-is-illegal-in-latex-block-but-there-is-no-blank-line">&#8220;Blank line is illegal in latex block&#8221;, but there is no blank line</a></li>
<li><a class="reference internal" href="#a-newline-in-equations-double-backslash-becomes-single-backslash-and-eats-up-spaces">A newline in equations (double backslash) becomes single backslash and eats up spaces</a></li>
<li><a class="reference internal" href="#preprocess-error-unexpected-eof-while-parsing">Preprocess error: unexpected EOF while parsing</a></li>
<li><a class="reference internal" href="#when-i-set-a-large-portion-of-text-in-color-only-a-part-of-it-becomes-colored">When I set a large portion of text in color, only a part of it becomes colored</a></li>
<li><a class="reference internal" href="#how-can-i-make-use-of-a-native-latex-environments-example-environment-for-instance">How can I make use of a native LaTeX environments (example environment for instance)?</a></li>
<li><a class="reference internal" href="#how-can-i-create-a-more-tailored-code-environment-in-latex-than-what-doconce-offers">How can I create a more tailored code environment in LaTeX than what DocOnce offers?</a></li>
<li><a class="reference internal" href="#how-can-links-open-in-new-tabs-windows">How can links open in new tabs/windows</a></li>
<li><a class="reference internal" href="#movies-will-not-play-in-my-broswer">Movies will not play in my broswer</a></li>
<li><a class="reference internal" href="#reveal-slides-look-strange-in-the-browser">Reveal slides look strange in the browser</a></li>
<li><a class="reference internal" href="#how-can-i-control-the-vertical-spacing-in-slides">How can I control the vertical spacing in slides?</a></li>
<li><a class="reference internal" href="#how-do-i-insert-a-copyright">How do I insert a copyright?</a><ul>
<li><a class="reference internal" href="#other-formats">Other formats</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-can-i-get-a-copyright-on-every-slide-page">How can I get a copyright on every slide page?</a></li>
<li><a class="reference internal" href="#how-do-i-get-figure-written-in-another-language">How do I get &#8220;Figure&#8221; written in another language?</a></li>
<li><a class="reference internal" href="#spellcheck-reports-mistakes-that-i-cannot-find">Spellcheck reports mistakes that I cannot find</a></li>
<li><a class="reference internal" href="#spellcheck-reports-a-lot-of-mistakes-related-to-latex-math">Spellcheck reports a lot of mistakes related to LaTeX math</a></li>
<li><a class="reference internal" href="#text-between-subexercises-are-moved">Text between subexercises are moved</a></li>
<li><a class="reference internal" href="#doconce-aborts-because-of-a-syntax-error-that-is-not-an-error">DocOnce aborts because of a syntax error that is not an error</a></li>
<li><a class="reference internal" href="#figure-captions-are-incomplete">Figure captions are incomplete</a></li>
<li><a class="reference internal" href="#problems-with-boldface-and-emphasize">Problems with boldface and emphasize</a></li>
<li><a class="reference internal" href="#links-to-local-directories-do-not-work">Links to local directories do not work</a></li>
<li><a class="reference internal" href="#links-are-not-typeset-correctly">Links are not typeset correctly</a></li>
<li><a class="reference internal" href="#inline-verbatim-code-or-boldface-is-not-detected-when-used-with-a-footnote">Inline verbatim code or boldface is not detected when used with a footnote</a></li>
<li><a class="reference internal" href="#inline-verbatim-code-is-not-detected">Inline verbatim code is not detected</a></li>
<li><a class="reference internal" href="#inline-verbatim-text-is-not-formatted-correctly">Inline verbatim text is not formatted correctly</a></li>
<li><a class="reference internal" href="#strange-non-english-characters">Strange non-English characters</a></li>
<li><a class="reference internal" href="#wrong-norwegian-characters">Wrong Norwegian characters</a></li>
<li><a class="reference internal" href="#too-short-underlining-of-rest-headlines">Too short underlining of reST headlines</a></li>
<li><a class="reference internal" href="#found-bt-but-no-tex-blocks-extracted-bug">Found <code class="docutils literal"><span class="pre">!bt</span></code> but no tex blocks extracted (BUG)</a></li>
<li><a class="reference internal" href="#examples-are-typset-with-environment-delimiters-visible">Examples are typset with environment delimiters visible</a></li>
<li><a class="reference internal" href="#emacs-editing-does-not-work-properly-because-of-regexp-overflow">Emacs editing does not work properly because of &#8220;regexp overflow&#8221;</a></li>
<li><a class="reference internal" href="#my-machine-hangs-if-i-have-many-movies">My machine hangs if I have many movies</a></li>
<li><a class="reference internal" href="#how-can-i-use-quotes-in-a-link">How can I use quotes in a link?</a></li>
<li><a class="reference internal" href="#conversion-from-doconce-to-google-docs">Conversion from DocOnce to Google Docs</a></li>
<li><a class="reference internal" href="#convesion-from-google-docs-to-doconce">Convesion from Google Docs to DocOnce</a></li>
<li><a class="reference internal" href="#are-there-any-tools-for-shared-online-writing-of-doconce-documents">Are there any tools for shared online writing of DocOnce documents?</a></li>
<li><a class="reference internal" href="#examples-on-seemingly-legal-syntax-that-fails">Examples on seemingly legal syntax that fails</a><ul>
<li><a class="reference internal" href="#double-bold-italic">Double bold/italic</a></li>
<li><a class="reference internal" href="#mix-of-bold-italic-and-math">Mix of bold/italic and math</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-can-i-make-pressbooks-com-books-from-doconce">How can I make pressbooks.com books from DocOnce?</a></li>
<li><a class="reference internal" href="#how-can-i-produce-epub-books-from-doconce">How can I produce ePub books from DocOnce?</a></li>
<li><a class="reference internal" href="#what-about-non-english-languages-and-doconce">What about non-English languages and DocOnce?</a></li>
<li><a class="reference internal" href="#lists-look-wrong">Lists look wrong</a></li>
<li><a class="reference internal" href="#how-can-i-get-an-overview-of-all-files-that-are-included-in-a-document">How can I get an overview of all files that are included in a document?</a></li>
<li><a class="reference internal" href="#how-to-write-the-dollar-sign-for-an-amount-in-dollars">How to write the dollar sign for an amount in dollars?</a></li>
<li><a class="reference internal" href="#problems-with-externaldocuments-specifications">Problems with Externaldocuments specifications</a></li>
<li><a class="reference internal" href="#what-is-the-difference-between-doconce-replace-and-doconce-subst">What is the difference between doconce replace and doconce subst?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preprocess-mako">Preprocess/Mako</a><ul>
<li><a class="reference internal" href="#list-important-things-to-remember-when-programming-mako">List important things to remember when programming Mako</a></li>
<li><a class="reference internal" href="#the-mako-preprocessor-is-fooled-by-doconce-text">The Mako preprocessor is fooled by DocOnce text</a></li>
<li><a class="reference internal" href="#the-mako-preprocessor-has-problems-with-lines-starting-with-percent-sign">The Mako preprocessor has problems with lines starting with percent sign</a></li>
<li><a class="reference internal" href="#the-mako-preprocessor-gives-syntax-error-in-python-code">The Mako preprocessor gives syntax error in Python code</a></li>
<li><a class="reference internal" href="#the-mako-preprocessor-gives-strange-error-messages">The Mako preprocessor gives strange error messages</a></li>
<li><a class="reference internal" href="#the-mako-preprocessor-claims-a-variable-is-undefined">The Mako preprocessor claims a variable is undefined</a></li>
<li><a class="reference internal" href="#something-goes-wrong-in-the-preprocessing-step">Something goes wrong in the preprocessing step</a></li>
<li><a class="reference internal" href="#preprocessor-directives-do-not-work">Preprocessor directives do not work</a></li>
</ul>
</li>
<li><a class="reference internal" href="#code-or-tex-blocks">Code or Tex Blocks</a><ul>
<li><a class="reference internal" href="#too-long-lines-in-math-blocks">Too long lines in math blocks</a></li>
<li><a class="reference internal" href="#code-or-math-block-errors-in-rest">Code or math block errors in reST</a></li>
<li><a class="reference internal" href="#strange-errors-around-code-or-tex-blocks-in-rest">Strange errors around code or TeX blocks in reST</a></li>
<li><a class="reference internal" href="#something-is-wrong-with-a-verbatim-code-block">Something is wrong with a verbatim code block</a></li>
<li><a class="reference internal" href="#code-tex-block-is-not-shown-in-rest-format">Code/TeX block is not shown in reST format</a></li>
<li><a class="reference internal" href="#verbatim-code-blocks-figures-and-admons-inside-lists-look-ugly">Verbatim code blocks, figures and admons inside lists look ugly</a></li>
<li><a class="reference internal" href="#latex-code-blocks-inside-lists-look-ugly">LaTeX code blocks inside lists look ugly</a></li>
<li><a class="reference internal" href="#latex-code-appears-prior-to-paragraph-headings">LaTeX code appears prior to paragraph headings</a></li>
<li><a class="reference internal" href="#numbered-equations-in-exercise-solutions-change-the-equation-numbers-in-the-text">Numbered equations in exercise solutions change the equation numbers in the text...</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rest-sphinx">reST/Sphinx</a><ul>
<li><a class="reference internal" href="#math-formulas-are-not-rendered-properly">Math formulas are not rendered properly</a></li>
<li><a class="reference internal" href="#sphinx-directory-generation-aborts-with-label-empty-or-too-long">Sphinx directory generation aborts with &#8220;label empty or too long&#8221;</a></li>
<li><a class="reference internal" href="#title-level-inconsistent">Title level inconsistent</a></li>
<li><a class="reference internal" href="#subsection-headings-appear-at-the-level-of-sections-in-the-table-of-contents">Subsection headings appear at the level of sections in the table of contents</a></li>
<li><a class="reference internal" href="#lists-do-not-appear-in-rst-files">Lists do not appear in .rst files</a></li>
<li><a class="reference internal" href="#error-message-undefined-substitution-from-rest">Error message &#8220;Undefined substitution...&#8221; from reST</a></li>
<li><a class="reference internal" href="#warning-about-duplicate-link-names">Warning about duplicate link names</a></li>
<li><a class="reference internal" href="#inconsistent-headings-in-rest">Inconsistent headings in reST</a></li>
<li><a class="reference internal" href="#no-code-environment-appears-before-bc-ipy-blocks">No code environment appears before &#8220;bc ipy&#8221; blocks</a></li>
<li><a class="reference internal" href="#lines-are-too-long">=====  Lines are too long</a></li>
<li><a class="reference internal" href="#tables-get-too-wide-need-to-wrap-text-in-the-columns">Tables get too wide - need to wrap text in the columns</a></li>
<li><a class="reference internal" href="#table-inside-user-defined-environment-does-not-work">Table inside user-defined environment does not work</a></li>
<li><a class="reference internal" href="#inline-figures-should-have-more-vertical-space">Inline figures should have more vertical space</a></li>
<li><a class="reference internal" href="#how-can-i-use-a-special-package-for-typesetting-code-k-not-pyg-lst-or-vrb">How can I use a special package for typesetting code?K (not <code class="docutils literal"><span class="pre">pyg</span></code>, <code class="docutils literal"><span class="pre">lst</span></code>, or <code class="docutils literal"><span class="pre">vrb</span></code>)</a></li>
<li><a class="reference internal" href="#sphinx-and-html-show-pygmetized-code-but-not-latex">Sphinx and HTML show pygmetized code, but not LaTeX</a></li>
<li><a class="reference internal" href="#latex-error-because-of-underscores">LaTeX error because of underscores</a></li>
<li><a class="reference internal" href="#latex-does-not-like-underscores-in-urls">LaTeX does not like underscores in URLs</a></li>
<li><a class="reference internal" href="#inline-verbatim-fails-in-admon-headings">Inline verbatim fails in admon headings</a></li>
<li><a class="reference internal" href="#how-can-i-customize-the-look-of-an-admonition">How can I customize the look of an admonition?</a></li>
<li><a class="reference internal" href="#how-can-i-have-unnumbered-sections">How can I have unnumbered sections?</a></li>
<li><a class="reference internal" href="#latex-suddenly-places-figures-differently">LaTeX suddenly places figures differently</a></li>
<li><a class="reference internal" href="#i-want-figure-references-with-page-number-too">I want figure references with page number too</a><ul>
<li><a class="reference internal" href="#quick-solution-with-the-varioref-package">Quick solution with the <code class="docutils literal"><span class="pre">varioref</span></code> package</a></li>
<li><a class="reference internal" href="#manual-solution-or-a-good-example-on-what-mako-can-do">Manual solution (or a good example on what Mako can do)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#error-when-running-latex-you-must-have-pygmentize-installed">Error when running latex: You must have &#8216;pygmentize&#8217; installed</a></li>
<li><a class="reference internal" href="#why-are-the-latex-section-headings-smaller-than-normal">Why are the LaTeX section headings smaller than normal?</a></li>
<li><a class="reference internal" href="#i-get-latex-compilation-errors-about-shadedquoteblue-in-code-blocks-in-exercises">I get LaTeX compilation errors about &#8220;shadedquoteBlue&#8221; in code blocks in exercises</a></li>
<li><a class="reference internal" href="#i-get-compilation-error-due-to-pause-commands">I get compilation error due to pause commands</a></li>
<li><a class="reference internal" href="#the-cell-structure-in-slides-does-not-work-for-me">The cell structure in slides does not work for me ...</a></li>
<li><a class="reference internal" href="#can-i-have-latex-figures-with-shadows">Can I have LaTeX figures with shadows?</a></li>
<li><a class="reference internal" href="#how-can-i-use-my-fancy-latex-environments">How can I use my fancy LaTeX environments?</a></li>
<li><a class="reference internal" href="#the-latex-file-does-not-compile">The LaTeX file does not compile</a></li>
<li><a class="reference internal" href="#the-latex-beamer-file-does-not-compile">The LaTeX Beamer file does not compile</a></li>
<li><a class="reference internal" href="#inline-verbatim-gives-error">Inline verbatim gives error</a></li>
<li><a class="reference internal" href="#errors-in-figure-captions">Errors in figure captions</a></li>
<li><a class="reference internal" href="#i-want-to-tune-the-top-preamble-of-the-latex-file">I want to tune the top (preamble) of the LaTeX file</a></li>
<li><a class="reference internal" href="#how-can-i-control-the-placement-of-figures">How can I control the placement of figures?</a></li>
<li><a class="reference internal" href="#how-can-i-get-a-two-column-text">How can I get a two-column text?</a></li>
<li><a class="reference internal" href="#solution-heading-in-exercise-solutions-appear-after-the-solution-content">Solution heading in exercise solutions appear after the solution content</a></li>
<li><a class="reference internal" href="#subexercises-subex-a-triggers-missing-number-treated-as-zero">Subexercises (<code class="docutils literal"><span class="pre">subex{a)}</span></code>) triggers &#8220;Missing number, treated as zero&#8221;</a></li>
<li><a class="reference internal" href="#page-numbers-appear-in-both-header-and-footer">Page numbers appear in both header and footer</a></li>
<li><a class="reference internal" href="#links-in-the-table-of-contents-go-to-wrong-page">Links in the table of contents go to wrong page</a></li>
<li><a class="reference internal" href="#exercises-in-the-springer-sv-style-looks-strange">Exercises in the <code class="docutils literal"><span class="pre">Springer_sv</span></code> style looks strange</a></li>
<li><a class="reference internal" href="#how-to-typeset-papers-with-specified-style-files">How to typeset papers with specified style files?</a></li>
<li><a class="reference internal" href="#strange-nested-lists-in-gwiki">=====  Strange nested lists in gwiki</a></li>
<li><a class="reference internal" href="#lists-in-gwiki-look-ugly-in-the-gwiki-source">Lists in gwiki look ugly in the gwiki source</a></li>
</ul>
</li>
<li><a class="reference internal" href="#html">HTML</a><ul>
<li><a class="reference internal" href="#how-can-i-add-a-search-facility-to-an-html-document">How can I add a search facility to an HTML document?</a></li>
<li><a class="reference internal" href="#mathjax-formulas-are-not-properly-rendered">MathJax formulas are not properly rendered</a></li>
<li><a class="reference internal" href="#how-can-i-change-the-layout-of-the-html-page">How can I change the layout of the HTML page?</a><ul>
<li><a class="reference internal" href="#autoedits-of-the-html-file">Autoedits of the <code class="docutils literal"><span class="pre">.html</span></code> file</a></li>
<li><a class="reference internal" href="#specify-a-css-file">Specify a <code class="docutils literal"><span class="pre">.css</span></code> file</a></li>
<li><a class="reference internal" href="#specify-a-template">Specify a template</a></li>
</ul>
</li>
<li><a class="reference internal" href="#why-do-figures-look-ugly-when-using-html-templates">Why do figures look ugly when using HTML templates?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reveal-deck-html5-slides">reveal/deck HTML5 slides</a><ul>
<li><a class="reference internal" href="#python-online-tutor-code-does-not-work-in-reveal">Python Online Tutor code does not work in reveal</a></li>
<li><a class="reference internal" href="#reveal-slides-are-stacked-on-top-of-each-other">Reveal slides are stacked on top of each other</a></li>
<li><a class="reference internal" href="#reveal-slides-are-moving-steadily-to-the-left">Reveal slides are moving steadily to the left</a></li>
<li><a class="reference internal" href="#youtube-movies-do-not-work">YouTube movies do not work</a></li>
<li><a class="reference internal" href="#online-python-tutor-does-not-work">Online Python Tutor does not work</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">DocOnce Troubleshooting and FAQ</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/trouble.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="DocOnce Troubleshooting and FAQ"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">DocOnce Troubleshooting and FAQ</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2016, Hans Petter Langtangen.
  </div>
</div>

  </body>
</html>